INFO:root:Using: cuda:0
INFO:root:Using seed 1234.
INFO:root:LPModel(
  (encoder): HNN(
    (layers): Sequential(
      (0): HNNLayer(
        (linear): HypLinear(
          in_features=501, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
      (1): HNNLayer(
        (linear): HypLinear(
          in_features=16, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
    )
  )
  (dc): FermiDiracDecoder()
)
INFO:root:Total number of parameters: 8305
/workspace/anaconda3/envs/geo/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:370: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  "please use `get_last_lr()`.", UserWarning)
INFO:root:Epoch: 0005 lr: 0.01 train_loss: 1.8787 train_roc: 0.5682 train_ap: 0.5682 time: 0.6164s
INFO:root:Epoch: 0005 val_loss: 1.7992 val_roc: 0.6014 val_ap: 0.6049
INFO:root:Epoch: 0010 lr: 0.01 train_loss: 1.6734 train_roc: 0.6108 train_ap: 0.6181 time: 0.6021s
INFO:root:Epoch: 0010 val_loss: 1.5843 val_roc: 0.6150 val_ap: 0.6147
INFO:root:Epoch: 0015 lr: 0.01 train_loss: 1.4859 train_roc: 0.6230 train_ap: 0.6241 time: 0.6017s
INFO:root:Epoch: 0015 val_loss: 1.4222 val_roc: 0.6421 val_ap: 0.6398
INFO:root:Epoch: 0020 lr: 0.01 train_loss: 1.3798 train_roc: 0.6380 train_ap: 0.6373 time: 0.6206s
INFO:root:Epoch: 0020 val_loss: 1.3242 val_roc: 0.6747 val_ap: 0.6743
INFO:root:Epoch: 0025 lr: 0.01 train_loss: 1.3675 train_roc: 0.6517 train_ap: 0.6623 time: 0.6221s
INFO:root:Epoch: 0025 val_loss: 1.2464 val_roc: 0.7241 val_ap: 0.7278
INFO:root:Epoch: 0030 lr: 0.01 train_loss: 1.2279 train_roc: 0.7280 train_ap: 0.7370 time: 0.6065s
INFO:root:Epoch: 0030 val_loss: 1.1324 val_roc: 0.7838 val_ap: 0.7832
INFO:root:Epoch: 0035 lr: 0.01 train_loss: 1.1543 train_roc: 0.7740 train_ap: 0.7796 time: 0.5958s
INFO:root:Epoch: 0035 val_loss: 1.0228 val_roc: 0.8311 val_ap: 0.8245
INFO:root:Epoch: 0040 lr: 0.01 train_loss: 1.1140 train_roc: 0.7935 train_ap: 0.7915 time: 0.5883s
INFO:root:Epoch: 0040 val_loss: 0.9748 val_roc: 0.8526 val_ap: 0.8452
INFO:root:Epoch: 0045 lr: 0.01 train_loss: 1.0863 train_roc: 0.8097 train_ap: 0.8078 time: 0.5919s
INFO:root:Epoch: 0045 val_loss: 0.9064 val_roc: 0.8751 val_ap: 0.8670
INFO:root:Epoch: 0050 lr: 0.01 train_loss: 0.9991 train_roc: 0.8441 train_ap: 0.8386 time: 0.5899s
INFO:root:Epoch: 0050 val_loss: 0.8656 val_roc: 0.8871 val_ap: 0.8778
INFO:root:Epoch: 0055 lr: 0.01 train_loss: 1.0307 train_roc: 0.8295 train_ap: 0.8287 time: 1.6710s
INFO:root:Epoch: 0055 val_loss: 0.8391 val_roc: 0.8932 val_ap: 0.8825
INFO:root:Epoch: 0060 lr: 0.01 train_loss: 0.9446 train_roc: 0.8597 train_ap: 0.8502 time: 1.6635s
INFO:root:Epoch: 0060 val_loss: 0.8053 val_roc: 0.9025 val_ap: 0.8910
INFO:root:Epoch: 0065 lr: 0.01 train_loss: 0.9581 train_roc: 0.8552 train_ap: 0.8459 time: 1.6576s
INFO:root:Epoch: 0065 val_loss: 0.7801 val_roc: 0.9088 val_ap: 0.8963
INFO:root:Epoch: 0070 lr: 0.01 train_loss: 0.9235 train_roc: 0.8711 train_ap: 0.8603 time: 1.6954s
INFO:root:Epoch: 0070 val_loss: 0.7709 val_roc: 0.9105 val_ap: 0.8973
INFO:root:Epoch: 0075 lr: 0.01 train_loss: 0.8979 train_roc: 0.8734 train_ap: 0.8584 time: 1.6858s
INFO:root:Epoch: 0075 val_loss: 0.7666 val_roc: 0.9114 val_ap: 0.8984
INFO:root:Epoch: 0080 lr: 0.01 train_loss: 0.8850 train_roc: 0.8789 train_ap: 0.8672 time: 1.6689s
INFO:root:Epoch: 0080 val_loss: 0.7572 val_roc: 0.9128 val_ap: 0.8991
INFO:root:Epoch: 0085 lr: 0.01 train_loss: 0.8865 train_roc: 0.8795 train_ap: 0.8639 time: 1.7365s
INFO:root:Epoch: 0085 val_loss: 0.7536 val_roc: 0.9138 val_ap: 0.8994
INFO:root:Epoch: 0090 lr: 0.01 train_loss: 0.8879 train_roc: 0.8778 train_ap: 0.8650 time: 1.7217s
INFO:root:Epoch: 0090 val_loss: 0.7599 val_roc: 0.9157 val_ap: 0.9015
INFO:root:Epoch: 0095 lr: 0.01 train_loss: 0.8734 train_roc: 0.8873 train_ap: 0.8741 time: 1.7155s
INFO:root:Epoch: 0095 val_loss: 0.7659 val_roc: 0.9155 val_ap: 0.9008
INFO:root:Epoch: 0100 lr: 0.01 train_loss: 0.8558 train_roc: 0.8901 train_ap: 0.8769 time: 1.6829s
INFO:root:Epoch: 0100 val_loss: 0.7568 val_roc: 0.9141 val_ap: 0.8996
INFO:root:Epoch: 0105 lr: 0.01 train_loss: 0.8319 train_roc: 0.8929 train_ap: 0.8756 time: 1.7129s
INFO:root:Epoch: 0105 val_loss: 0.7494 val_roc: 0.9151 val_ap: 0.9014
INFO:root:Epoch: 0110 lr: 0.01 train_loss: 0.8885 train_roc: 0.8865 train_ap: 0.8692 time: 1.6069s
INFO:root:Epoch: 0110 val_loss: 0.7452 val_roc: 0.9172 val_ap: 0.9040
INFO:root:Epoch: 0115 lr: 0.01 train_loss: 0.8588 train_roc: 0.8876 train_ap: 0.8763 time: 1.6624s
INFO:root:Epoch: 0115 val_loss: 0.7417 val_roc: 0.9186 val_ap: 0.9051
INFO:root:Epoch: 0120 lr: 0.01 train_loss: 0.8505 train_roc: 0.8923 train_ap: 0.8794 time: 1.7000s
INFO:root:Epoch: 0120 val_loss: 0.7342 val_roc: 0.9192 val_ap: 0.9047
INFO:root:Epoch: 0125 lr: 0.01 train_loss: 0.8611 train_roc: 0.8881 train_ap: 0.8722 time: 1.6872s
INFO:root:Epoch: 0125 val_loss: 0.7331 val_roc: 0.9181 val_ap: 0.9027
INFO:root:Epoch: 0130 lr: 0.01 train_loss: 0.8330 train_roc: 0.8952 train_ap: 0.8791 time: 1.7064s
INFO:root:Epoch: 0130 val_loss: 0.7365 val_roc: 0.9182 val_ap: 0.9026
INFO:root:Epoch: 0135 lr: 0.01 train_loss: 0.8691 train_roc: 0.8828 train_ap: 0.8657 time: 1.7648s
INFO:root:Epoch: 0135 val_loss: 0.7452 val_roc: 0.9216 val_ap: 0.9078
INFO:root:Epoch: 0140 lr: 0.01 train_loss: 0.8377 train_roc: 0.8984 train_ap: 0.8823 time: 1.6851s
INFO:root:Epoch: 0140 val_loss: 0.7387 val_roc: 0.9213 val_ap: 0.9081
INFO:root:Epoch: 0145 lr: 0.01 train_loss: 0.8200 train_roc: 0.8997 train_ap: 0.8855 time: 1.7396s
INFO:root:Epoch: 0145 val_loss: 0.7290 val_roc: 0.9205 val_ap: 0.9069
INFO:root:Epoch: 0150 lr: 0.01 train_loss: 0.8237 train_roc: 0.8976 train_ap: 0.8838 time: 1.7653s
INFO:root:Epoch: 0150 val_loss: 0.7256 val_roc: 0.9208 val_ap: 0.9068
INFO:root:Epoch: 0155 lr: 0.01 train_loss: 0.8210 train_roc: 0.8996 train_ap: 0.8873 time: 1.7432s
INFO:root:Epoch: 0155 val_loss: 0.7182 val_roc: 0.9220 val_ap: 0.9077
INFO:root:Epoch: 0160 lr: 0.01 train_loss: 0.8586 train_roc: 0.8930 train_ap: 0.8792 time: 1.7273s
INFO:root:Epoch: 0160 val_loss: 0.7219 val_roc: 0.9222 val_ap: 0.9080
INFO:root:Epoch: 0165 lr: 0.01 train_loss: 0.8256 train_roc: 0.8954 train_ap: 0.8802 time: 0.5840s
INFO:root:Epoch: 0165 val_loss: 0.7191 val_roc: 0.9220 val_ap: 0.9083
INFO:root:Epoch: 0170 lr: 0.01 train_loss: 0.8259 train_roc: 0.8974 train_ap: 0.8857 time: 0.5989s
INFO:root:Epoch: 0170 val_loss: 0.7202 val_roc: 0.9222 val_ap: 0.9078
INFO:root:Epoch: 0175 lr: 0.01 train_loss: 0.8153 train_roc: 0.8972 train_ap: 0.8794 time: 0.5905s
INFO:root:Epoch: 0175 val_loss: 0.7368 val_roc: 0.9220 val_ap: 0.9073
INFO:root:Epoch: 0180 lr: 0.01 train_loss: 0.8702 train_roc: 0.8850 train_ap: 0.8754 time: 0.5910s
INFO:root:Epoch: 0180 val_loss: 0.7248 val_roc: 0.9224 val_ap: 0.9073
INFO:root:Epoch: 0185 lr: 0.01 train_loss: 0.8029 train_roc: 0.9072 train_ap: 0.8933 time: 0.5966s
INFO:root:Epoch: 0185 val_loss: 0.7139 val_roc: 0.9236 val_ap: 0.9081
INFO:root:Epoch: 0190 lr: 0.01 train_loss: 0.8136 train_roc: 0.8989 train_ap: 0.8833 time: 0.5998s
INFO:root:Epoch: 0190 val_loss: 0.7198 val_roc: 0.9246 val_ap: 0.9094
INFO:root:Epoch: 0195 lr: 0.01 train_loss: 0.8141 train_roc: 0.9015 train_ap: 0.8872 time: 0.6002s
INFO:root:Epoch: 0195 val_loss: 0.7112 val_roc: 0.9244 val_ap: 0.9095
INFO:root:Epoch: 0200 lr: 0.01 train_loss: 0.8275 train_roc: 0.8973 train_ap: 0.8847 time: 0.5954s
INFO:root:Epoch: 0200 val_loss: 0.7154 val_roc: 0.9247 val_ap: 0.9110
INFO:root:Epoch: 0205 lr: 0.01 train_loss: 0.8052 train_roc: 0.9024 train_ap: 0.8876 time: 0.5902s
INFO:root:Epoch: 0205 val_loss: 0.7230 val_roc: 0.9246 val_ap: 0.9113
INFO:root:Epoch: 0210 lr: 0.01 train_loss: 0.8022 train_roc: 0.9029 train_ap: 0.8894 time: 0.5860s
INFO:root:Epoch: 0210 val_loss: 0.7154 val_roc: 0.9246 val_ap: 0.9109
INFO:root:Epoch: 0215 lr: 0.01 train_loss: 0.8273 train_roc: 0.8970 train_ap: 0.8841 time: 0.5952s
INFO:root:Epoch: 0215 val_loss: 0.7168 val_roc: 0.9241 val_ap: 0.9098
INFO:root:Epoch: 0220 lr: 0.01 train_loss: 0.8064 train_roc: 0.9070 train_ap: 0.8928 time: 0.5970s
INFO:root:Epoch: 0220 val_loss: 0.7203 val_roc: 0.9252 val_ap: 0.9109
INFO:root:Epoch: 0225 lr: 0.01 train_loss: 0.8243 train_roc: 0.9034 train_ap: 0.8935 time: 0.5940s
INFO:root:Epoch: 0225 val_loss: 0.7082 val_roc: 0.9258 val_ap: 0.9119
INFO:root:Epoch: 0230 lr: 0.01 train_loss: 0.8097 train_roc: 0.9034 train_ap: 0.8886 time: 0.5998s
INFO:root:Epoch: 0230 val_loss: 0.7153 val_roc: 0.9241 val_ap: 0.9103
INFO:root:Epoch: 0235 lr: 0.01 train_loss: 0.8076 train_roc: 0.9034 train_ap: 0.8910 time: 0.5866s
INFO:root:Epoch: 0235 val_loss: 0.7084 val_roc: 0.9254 val_ap: 0.9120
INFO:root:Epoch: 0240 lr: 0.01 train_loss: 0.8018 train_roc: 0.9036 train_ap: 0.8895 time: 0.5940s
INFO:root:Epoch: 0240 val_loss: 0.7164 val_roc: 0.9263 val_ap: 0.9127
INFO:root:Epoch: 0245 lr: 0.01 train_loss: 0.8019 train_roc: 0.9041 train_ap: 0.8898 time: 0.5855s
INFO:root:Epoch: 0245 val_loss: 0.7182 val_roc: 0.9259 val_ap: 0.9119
INFO:root:Epoch: 0250 lr: 0.01 train_loss: 0.8009 train_roc: 0.9030 train_ap: 0.8903 time: 0.5850s
INFO:root:Epoch: 0250 val_loss: 0.7135 val_roc: 0.9251 val_ap: 0.9108
INFO:root:Epoch: 0255 lr: 0.01 train_loss: 0.8177 train_roc: 0.8992 train_ap: 0.8833 time: 0.5943s
INFO:root:Epoch: 0255 val_loss: 0.7115 val_roc: 0.9238 val_ap: 0.9087
INFO:root:Epoch: 0260 lr: 0.01 train_loss: 0.8104 train_roc: 0.9037 train_ap: 0.8886 time: 0.5912s
INFO:root:Epoch: 0260 val_loss: 0.7126 val_roc: 0.9245 val_ap: 0.9090
INFO:root:Epoch: 0265 lr: 0.01 train_loss: 0.8249 train_roc: 0.8978 train_ap: 0.8853 time: 0.5822s
INFO:root:Epoch: 0265 val_loss: 0.7389 val_roc: 0.9251 val_ap: 0.9110
INFO:root:Epoch: 0270 lr: 0.01 train_loss: 0.7971 train_roc: 0.9034 train_ap: 0.8865 time: 0.5952s
INFO:root:Epoch: 0270 val_loss: 0.7320 val_roc: 0.9227 val_ap: 0.9087
INFO:root:Epoch: 0275 lr: 0.01 train_loss: 0.8154 train_roc: 0.9009 train_ap: 0.8872 time: 0.5924s
INFO:root:Epoch: 0275 val_loss: 0.7127 val_roc: 0.9233 val_ap: 0.9090
INFO:root:Epoch: 0280 lr: 0.01 train_loss: 0.7860 train_roc: 0.9070 train_ap: 0.8915 time: 0.5924s
INFO:root:Epoch: 0280 val_loss: 0.7104 val_roc: 0.9245 val_ap: 0.9098
INFO:root:Epoch: 0285 lr: 0.01 train_loss: 0.8304 train_roc: 0.8976 train_ap: 0.8825 time: 0.5957s
INFO:root:Epoch: 0285 val_loss: 0.7077 val_roc: 0.9253 val_ap: 0.9113
INFO:root:Epoch: 0290 lr: 0.01 train_loss: 0.7741 train_roc: 0.9125 train_ap: 0.8979 time: 0.5922s
INFO:root:Epoch: 0290 val_loss: 0.7332 val_roc: 0.9262 val_ap: 0.9123
INFO:root:Epoch: 0295 lr: 0.01 train_loss: 0.8048 train_roc: 0.9017 train_ap: 0.8863 time: 0.6047s
INFO:root:Epoch: 0295 val_loss: 0.7098 val_roc: 0.9261 val_ap: 0.9113
INFO:root:Epoch: 0300 lr: 0.01 train_loss: 0.8022 train_roc: 0.9027 train_ap: 0.8875 time: 0.5939s
INFO:root:Epoch: 0300 val_loss: 0.7081 val_roc: 0.9246 val_ap: 0.9089
INFO:root:Epoch: 0305 lr: 0.01 train_loss: 0.8074 train_roc: 0.9009 train_ap: 0.8828 time: 0.6021s
INFO:root:Epoch: 0305 val_loss: 0.7061 val_roc: 0.9257 val_ap: 0.9105
INFO:root:Epoch: 0310 lr: 0.01 train_loss: 0.7966 train_roc: 0.9045 train_ap: 0.8893 time: 0.5949s
INFO:root:Epoch: 0310 val_loss: 0.7195 val_roc: 0.9259 val_ap: 0.9111
INFO:root:Epoch: 0315 lr: 0.01 train_loss: 0.8124 train_roc: 0.9055 train_ap: 0.8905 time: 0.6016s
INFO:root:Epoch: 0315 val_loss: 0.7112 val_roc: 0.9259 val_ap: 0.9111
INFO:root:Epoch: 0320 lr: 0.01 train_loss: 0.8271 train_roc: 0.8956 train_ap: 0.8786 time: 0.6060s
INFO:root:Epoch: 0320 val_loss: 0.7080 val_roc: 0.9250 val_ap: 0.9085
INFO:root:Epoch: 0325 lr: 0.01 train_loss: 0.8134 train_roc: 0.9007 train_ap: 0.8857 time: 0.6224s
INFO:root:Epoch: 0325 val_loss: 0.7134 val_roc: 0.9254 val_ap: 0.9095
INFO:root:Epoch: 0330 lr: 0.01 train_loss: 0.7972 train_roc: 0.9085 train_ap: 0.8951 time: 0.5879s
INFO:root:Epoch: 0330 val_loss: 0.7138 val_roc: 0.9256 val_ap: 0.9108
INFO:root:Epoch: 0335 lr: 0.01 train_loss: 0.8095 train_roc: 0.9013 train_ap: 0.8879 time: 0.5909s
INFO:root:Epoch: 0335 val_loss: 0.7117 val_roc: 0.9258 val_ap: 0.9114
INFO:root:Early stopping
INFO:root:Optimization Finished!
INFO:root:Total time elapsed: 451.3461s
INFO:root:Val set results: val_loss: 0.7160 val_roc: 0.9262 val_ap: 0.9130
INFO:root:Test set results: test_loss: 0.7030 test_roc: 0.9272 test_ap: 0.9134
INFO:root:Saved model in /workspace/xiongbo/hgcn/logs/lp/2021_5_7/2
