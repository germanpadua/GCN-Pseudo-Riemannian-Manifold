INFO:root:Using: cuda:0
INFO:root:Using seed 1234.
INFO:root:LPModel(
  (encoder): HGCN(
    (layers): Sequential(
      (0): HyperbolicGraphConvolution(
        (linear): HypLinear(
          in_features=501, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (agg): HypAgg(
          c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
      (1): HyperbolicGraphConvolution(
        (linear): HypLinear(
          in_features=16, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (agg): HypAgg(
          c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
    )
  )
  (dc): FermiDiracDecoder()
)
INFO:root:Total number of parameters: 8307
/workspace/anaconda3/envs/geo/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:370: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  "please use `get_last_lr()`.", UserWarning)
INFO:root:Epoch: 0005 lr: 0.01 train_loss: 1.8988 train_roc: 0.7487 train_ap: 0.7187 time: 1.1390s
INFO:root:Epoch: 0005 val_loss: 1.8622 val_roc: 0.7478 val_ap: 0.7264
INFO:root:Epoch: 0010 lr: 0.01 train_loss: 1.8252 train_roc: 0.7780 train_ap: 0.7566 time: 1.1222s
INFO:root:Epoch: 0010 val_loss: 1.6675 val_roc: 0.8207 val_ap: 0.8108
INFO:root:Epoch: 0015 lr: 0.01 train_loss: 1.6060 train_roc: 0.8624 train_ap: 0.8472 time: 1.0915s
INFO:root:Epoch: 0015 val_loss: 1.4691 val_roc: 0.8536 val_ap: 0.8395
INFO:root:Epoch: 0020 lr: 0.01 train_loss: 1.4557 train_roc: 0.8917 train_ap: 0.8771 time: 1.0951s
INFO:root:Epoch: 0020 val_loss: 1.2426 val_roc: 0.8638 val_ap: 0.8504
INFO:root:Epoch: 0025 lr: 0.01 train_loss: 1.1513 train_roc: 0.9088 train_ap: 0.8914 time: 1.0626s
INFO:root:Epoch: 0025 val_loss: 1.0278 val_roc: 0.8693 val_ap: 0.8547
INFO:root:Epoch: 0030 lr: 0.01 train_loss: 0.9188 train_roc: 0.9204 train_ap: 0.9039 time: 1.0756s
INFO:root:Epoch: 0030 val_loss: 0.8986 val_roc: 0.8766 val_ap: 0.8635
INFO:root:Epoch: 0035 lr: 0.01 train_loss: 0.6774 train_roc: 0.9368 train_ap: 0.9246 time: 1.0939s
INFO:root:Epoch: 0035 val_loss: 0.9309 val_roc: 0.8842 val_ap: 0.8732
INFO:root:Epoch: 0040 lr: 0.01 train_loss: 0.6414 train_roc: 0.9427 train_ap: 0.9313 time: 1.0820s
INFO:root:Epoch: 0040 val_loss: 1.1623 val_roc: 0.8957 val_ap: 0.8880
INFO:root:Epoch: 0045 lr: 0.01 train_loss: 0.5741 train_roc: 0.9628 train_ap: 0.9554 time: 1.1594s
INFO:root:Epoch: 0045 val_loss: 1.1878 val_roc: 0.9069 val_ap: 0.9014
INFO:root:Epoch: 0050 lr: 0.01 train_loss: 0.5531 train_roc: 0.9631 train_ap: 0.9558 time: 1.1189s
INFO:root:Epoch: 0050 val_loss: 0.9318 val_roc: 0.9130 val_ap: 0.9091
INFO:root:Epoch: 0055 lr: 0.01 train_loss: 0.5092 train_roc: 0.9695 train_ap: 0.9622 time: 1.1122s
INFO:root:Epoch: 0055 val_loss: 0.9037 val_roc: 0.9203 val_ap: 0.9170
INFO:root:Epoch: 0060 lr: 0.01 train_loss: 0.4827 train_roc: 0.9725 train_ap: 0.9656 time: 1.1095s
INFO:root:Epoch: 0060 val_loss: 0.9207 val_roc: 0.9247 val_ap: 0.9196
INFO:root:Epoch: 0065 lr: 0.01 train_loss: 0.5006 train_roc: 0.9691 train_ap: 0.9600 time: 1.0849s
INFO:root:Epoch: 0065 val_loss: 0.8094 val_roc: 0.9268 val_ap: 0.9215
INFO:root:Epoch: 0070 lr: 0.01 train_loss: 0.5183 train_roc: 0.9718 train_ap: 0.9655 time: 1.1181s
INFO:root:Epoch: 0070 val_loss: 0.9084 val_roc: 0.9293 val_ap: 0.9234
INFO:root:Epoch: 0075 lr: 0.01 train_loss: 0.4788 train_roc: 0.9723 train_ap: 0.9654 time: 1.1303s
INFO:root:Epoch: 0075 val_loss: 0.8392 val_roc: 0.9321 val_ap: 0.9253
INFO:root:Epoch: 0080 lr: 0.01 train_loss: 0.4407 train_roc: 0.9784 train_ap: 0.9728 time: 1.0972s
INFO:root:Epoch: 0080 val_loss: 0.8660 val_roc: 0.9352 val_ap: 0.9288
INFO:root:Epoch: 0085 lr: 0.01 train_loss: 0.4666 train_roc: 0.9782 train_ap: 0.9729 time: 1.1605s
INFO:root:Epoch: 0085 val_loss: 0.8171 val_roc: 0.9346 val_ap: 0.9293
INFO:root:Epoch: 0090 lr: 0.01 train_loss: 0.4374 train_roc: 0.9796 train_ap: 0.9731 time: 2.9941s
INFO:root:Epoch: 0090 val_loss: 0.8139 val_roc: 0.9359 val_ap: 0.9303
INFO:root:Epoch: 0095 lr: 0.01 train_loss: 0.4278 train_roc: 0.9794 train_ap: 0.9731 time: 2.4057s
INFO:root:Epoch: 0095 val_loss: 0.8093 val_roc: 0.9382 val_ap: 0.9325
INFO:root:Epoch: 0100 lr: 0.01 train_loss: 0.4307 train_roc: 0.9808 train_ap: 0.9754 time: 2.4871s
INFO:root:Epoch: 0100 val_loss: 0.8701 val_roc: 0.9388 val_ap: 0.9322
INFO:root:Epoch: 0105 lr: 0.01 train_loss: 0.4085 train_roc: 0.9845 train_ap: 0.9798 time: 2.4879s
INFO:root:Epoch: 0105 val_loss: 0.8457 val_roc: 0.9396 val_ap: 0.9330
INFO:root:Epoch: 0110 lr: 0.01 train_loss: 0.4193 train_roc: 0.9818 train_ap: 0.9763 time: 2.4620s
INFO:root:Epoch: 0110 val_loss: 0.8406 val_roc: 0.9413 val_ap: 0.9352
INFO:root:Epoch: 0115 lr: 0.01 train_loss: 0.4298 train_roc: 0.9824 train_ap: 0.9776 time: 2.3889s
INFO:root:Epoch: 0115 val_loss: 0.7449 val_roc: 0.9420 val_ap: 0.9375
INFO:root:Epoch: 0120 lr: 0.01 train_loss: 0.4190 train_roc: 0.9820 train_ap: 0.9757 time: 3.0006s
INFO:root:Epoch: 0120 val_loss: 0.8068 val_roc: 0.9433 val_ap: 0.9402
INFO:root:Epoch: 0125 lr: 0.01 train_loss: 0.4227 train_roc: 0.9830 train_ap: 0.9791 time: 2.6903s
INFO:root:Epoch: 0125 val_loss: 0.8480 val_roc: 0.9447 val_ap: 0.9418
INFO:root:Epoch: 0130 lr: 0.01 train_loss: 0.4094 train_roc: 0.9832 train_ap: 0.9782 time: 2.7193s
INFO:root:Epoch: 0130 val_loss: 0.8895 val_roc: 0.9451 val_ap: 0.9416
INFO:root:Epoch: 0135 lr: 0.01 train_loss: 0.4274 train_roc: 0.9841 train_ap: 0.9792 time: 2.5247s
INFO:root:Epoch: 0135 val_loss: 0.7982 val_roc: 0.9426 val_ap: 0.9398
INFO:root:Epoch: 0140 lr: 0.01 train_loss: 0.4018 train_roc: 0.9852 train_ap: 0.9811 time: 2.4842s
INFO:root:Epoch: 0140 val_loss: 0.7572 val_roc: 0.9434 val_ap: 0.9407
INFO:root:Epoch: 0145 lr: 0.01 train_loss: 0.4240 train_roc: 0.9813 train_ap: 0.9763 time: 2.4063s
INFO:root:Epoch: 0145 val_loss: 0.9079 val_roc: 0.9471 val_ap: 0.9446
INFO:root:Epoch: 0150 lr: 0.01 train_loss: 0.4025 train_roc: 0.9844 train_ap: 0.9793 time: 2.5056s
INFO:root:Epoch: 0150 val_loss: 0.8768 val_roc: 0.9464 val_ap: 0.9444
INFO:root:Epoch: 0155 lr: 0.01 train_loss: 0.4059 train_roc: 0.9856 train_ap: 0.9817 time: 1.1151s
INFO:root:Epoch: 0155 val_loss: 0.7295 val_roc: 0.9475 val_ap: 0.9460
INFO:root:Epoch: 0160 lr: 0.01 train_loss: 0.3909 train_roc: 0.9849 train_ap: 0.9796 time: 1.0973s
INFO:root:Epoch: 0160 val_loss: 0.7263 val_roc: 0.9496 val_ap: 0.9481
INFO:root:Epoch: 0165 lr: 0.01 train_loss: 0.4182 train_roc: 0.9818 train_ap: 0.9765 time: 1.1272s
INFO:root:Epoch: 0165 val_loss: 0.7518 val_roc: 0.9506 val_ap: 0.9486
INFO:root:Epoch: 0170 lr: 0.01 train_loss: 0.3841 train_roc: 0.9882 train_ap: 0.9855 time: 1.1294s
INFO:root:Epoch: 0170 val_loss: 0.8047 val_roc: 0.9507 val_ap: 0.9488
INFO:root:Epoch: 0175 lr: 0.01 train_loss: 0.4038 train_roc: 0.9852 train_ap: 0.9804 time: 1.1452s
INFO:root:Epoch: 0175 val_loss: 0.9414 val_roc: 0.9506 val_ap: 0.9483
INFO:root:Epoch: 0180 lr: 0.01 train_loss: 0.3916 train_roc: 0.9851 train_ap: 0.9807 time: 1.1303s
INFO:root:Epoch: 0180 val_loss: 0.7793 val_roc: 0.9510 val_ap: 0.9493
INFO:root:Epoch: 0185 lr: 0.01 train_loss: 0.3843 train_roc: 0.9879 train_ap: 0.9848 time: 1.1075s
INFO:root:Epoch: 0185 val_loss: 0.7415 val_roc: 0.9525 val_ap: 0.9508
INFO:root:Epoch: 0190 lr: 0.01 train_loss: 0.3729 train_roc: 0.9892 train_ap: 0.9846 time: 1.0897s
INFO:root:Epoch: 0190 val_loss: 0.8813 val_roc: 0.9523 val_ap: 0.9496
INFO:root:Epoch: 0195 lr: 0.01 train_loss: 0.4065 train_roc: 0.9844 train_ap: 0.9797 time: 1.1125s
INFO:root:Epoch: 0195 val_loss: 0.9211 val_roc: 0.9508 val_ap: 0.9474
INFO:root:Epoch: 0200 lr: 0.01 train_loss: 0.3856 train_roc: 0.9862 train_ap: 0.9810 time: 1.1200s
INFO:root:Epoch: 0200 val_loss: 0.7973 val_roc: 0.9503 val_ap: 0.9473
INFO:root:Epoch: 0205 lr: 0.01 train_loss: 0.4195 train_roc: 0.9831 train_ap: 0.9782 time: 1.1148s
INFO:root:Epoch: 0205 val_loss: 0.7362 val_roc: 0.9521 val_ap: 0.9484
INFO:root:Epoch: 0210 lr: 0.01 train_loss: 0.3820 train_roc: 0.9878 train_ap: 0.9849 time: 1.0817s
INFO:root:Epoch: 0210 val_loss: 0.7949 val_roc: 0.9542 val_ap: 0.9516
INFO:root:Epoch: 0215 lr: 0.01 train_loss: 0.4210 train_roc: 0.9838 train_ap: 0.9801 time: 1.0859s
INFO:root:Epoch: 0215 val_loss: 0.7440 val_roc: 0.9543 val_ap: 0.9523
INFO:root:Epoch: 0220 lr: 0.01 train_loss: 0.3883 train_roc: 0.9873 train_ap: 0.9832 time: 1.1108s
INFO:root:Epoch: 0220 val_loss: 0.7796 val_roc: 0.9540 val_ap: 0.9516
INFO:root:Epoch: 0225 lr: 0.01 train_loss: 0.3836 train_roc: 0.9871 train_ap: 0.9841 time: 1.0892s
INFO:root:Epoch: 0225 val_loss: 0.7630 val_roc: 0.9533 val_ap: 0.9500
INFO:root:Epoch: 0230 lr: 0.01 train_loss: 0.3692 train_roc: 0.9879 train_ap: 0.9834 time: 1.0821s
INFO:root:Epoch: 0230 val_loss: 0.7805 val_roc: 0.9542 val_ap: 0.9513
INFO:root:Epoch: 0235 lr: 0.01 train_loss: 0.3911 train_roc: 0.9863 train_ap: 0.9830 time: 1.0991s
INFO:root:Epoch: 0235 val_loss: 0.7600 val_roc: 0.9544 val_ap: 0.9512
INFO:root:Epoch: 0240 lr: 0.01 train_loss: 0.3684 train_roc: 0.9889 train_ap: 0.9860 time: 1.0999s
INFO:root:Epoch: 0240 val_loss: 0.7240 val_roc: 0.9541 val_ap: 0.9504
INFO:root:Epoch: 0245 lr: 0.01 train_loss: 0.3778 train_roc: 0.9872 train_ap: 0.9829 time: 1.0830s
INFO:root:Epoch: 0245 val_loss: 0.6798 val_roc: 0.9538 val_ap: 0.9514
INFO:root:Epoch: 0250 lr: 0.01 train_loss: 0.3609 train_roc: 0.9905 train_ap: 0.9880 time: 1.1173s
INFO:root:Epoch: 0250 val_loss: 0.8154 val_roc: 0.9556 val_ap: 0.9537
INFO:root:Epoch: 0255 lr: 0.01 train_loss: 0.3983 train_roc: 0.9851 train_ap: 0.9802 time: 1.1086s
INFO:root:Epoch: 0255 val_loss: 0.8331 val_roc: 0.9553 val_ap: 0.9535
INFO:root:Epoch: 0260 lr: 0.01 train_loss: 0.3803 train_roc: 0.9876 train_ap: 0.9840 time: 1.0804s
INFO:root:Epoch: 0260 val_loss: 0.7429 val_roc: 0.9545 val_ap: 0.9528
INFO:root:Epoch: 0265 lr: 0.01 train_loss: 0.3645 train_roc: 0.9885 train_ap: 0.9851 time: 1.1149s
INFO:root:Epoch: 0265 val_loss: 0.7021 val_roc: 0.9534 val_ap: 0.9517
INFO:root:Epoch: 0270 lr: 0.01 train_loss: 0.3887 train_roc: 0.9880 train_ap: 0.9842 time: 1.1258s
INFO:root:Epoch: 0270 val_loss: 0.6977 val_roc: 0.9524 val_ap: 0.9504
INFO:root:Epoch: 0275 lr: 0.01 train_loss: 0.3792 train_roc: 0.9863 train_ap: 0.9816 time: 1.1062s
INFO:root:Epoch: 0275 val_loss: 0.7489 val_roc: 0.9524 val_ap: 0.9502
INFO:root:Epoch: 0280 lr: 0.01 train_loss: 0.3697 train_roc: 0.9889 train_ap: 0.9854 time: 1.1210s
INFO:root:Epoch: 0280 val_loss: 0.7871 val_roc: 0.9532 val_ap: 0.9512
INFO:root:Epoch: 0285 lr: 0.01 train_loss: 0.4033 train_roc: 0.9846 train_ap: 0.9800 time: 1.1148s
INFO:root:Epoch: 0285 val_loss: 0.7288 val_roc: 0.9541 val_ap: 0.9525
INFO:root:Epoch: 0290 lr: 0.01 train_loss: 0.3657 train_roc: 0.9891 train_ap: 0.9863 time: 1.0959s
INFO:root:Epoch: 0290 val_loss: 0.7326 val_roc: 0.9543 val_ap: 0.9534
INFO:root:Epoch: 0295 lr: 0.01 train_loss: 0.3836 train_roc: 0.9876 train_ap: 0.9842 time: 1.1024s
INFO:root:Epoch: 0295 val_loss: 0.8505 val_roc: 0.9536 val_ap: 0.9526
INFO:root:Epoch: 0300 lr: 0.01 train_loss: 0.3818 train_roc: 0.9876 train_ap: 0.9839 time: 1.1296s
INFO:root:Epoch: 0300 val_loss: 0.7318 val_roc: 0.9524 val_ap: 0.9512
INFO:root:Epoch: 0305 lr: 0.01 train_loss: 0.3923 train_roc: 0.9853 train_ap: 0.9798 time: 1.1073s
INFO:root:Epoch: 0305 val_loss: 0.7815 val_roc: 0.9530 val_ap: 0.9519
INFO:root:Epoch: 0310 lr: 0.01 train_loss: 0.4028 train_roc: 0.9882 train_ap: 0.9836 time: 1.1060s
INFO:root:Epoch: 0310 val_loss: 0.7904 val_roc: 0.9533 val_ap: 0.9524
INFO:root:Epoch: 0315 lr: 0.01 train_loss: 0.3677 train_roc: 0.9890 train_ap: 0.9858 time: 1.1307s
INFO:root:Epoch: 0315 val_loss: 0.7021 val_roc: 0.9530 val_ap: 0.9518
INFO:root:Epoch: 0320 lr: 0.01 train_loss: 0.3773 train_roc: 0.9885 train_ap: 0.9853 time: 1.1092s
INFO:root:Epoch: 0320 val_loss: 0.6622 val_roc: 0.9536 val_ap: 0.9512
INFO:root:Epoch: 0325 lr: 0.01 train_loss: 0.3770 train_roc: 0.9880 train_ap: 0.9847 time: 1.0990s
INFO:root:Epoch: 0325 val_loss: 0.7124 val_roc: 0.9543 val_ap: 0.9516
INFO:root:Epoch: 0330 lr: 0.01 train_loss: 0.3580 train_roc: 0.9897 train_ap: 0.9870 time: 1.1165s
INFO:root:Epoch: 0330 val_loss: 0.7863 val_roc: 0.9551 val_ap: 0.9519
INFO:root:Epoch: 0335 lr: 0.01 train_loss: 0.3702 train_roc: 0.9882 train_ap: 0.9846 time: 1.1056s
INFO:root:Epoch: 0335 val_loss: 0.7895 val_roc: 0.9542 val_ap: 0.9520
INFO:root:Epoch: 0340 lr: 0.01 train_loss: 0.3796 train_roc: 0.9876 train_ap: 0.9836 time: 1.1190s
INFO:root:Epoch: 0340 val_loss: 0.7938 val_roc: 0.9538 val_ap: 0.9510
INFO:root:Epoch: 0345 lr: 0.01 train_loss: 0.3663 train_roc: 0.9893 train_ap: 0.9857 time: 1.1172s
INFO:root:Epoch: 0345 val_loss: 0.6860 val_roc: 0.9533 val_ap: 0.9508
INFO:root:Epoch: 0350 lr: 0.01 train_loss: 0.3614 train_roc: 0.9903 train_ap: 0.9868 time: 1.0967s
INFO:root:Epoch: 0350 val_loss: 0.7696 val_roc: 0.9528 val_ap: 0.9513
INFO:root:Early stopping
INFO:root:Optimization Finished!
INFO:root:Total time elapsed: 700.8347s
INFO:root:Val set results: val_loss: 0.8457 val_roc: 0.9558 val_ap: 0.9539
INFO:root:Test set results: test_loss: 0.8655 test_roc: 0.9544 test_ap: 0.9523
INFO:root:Saved model in /workspace/xiongbo/hgcn/logs/lp/2021_5_2/24
