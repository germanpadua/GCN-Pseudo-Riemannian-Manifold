INFO:root:Using: cuda:0
INFO:root:Using seed 1234.
INFO:root:LPModel(
  (encoder): HNN(
    (layers): Sequential(
      (0): HNNLayer(
        (linear): HypLinear(
          in_features=3704, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
      (1): HNNLayer(
        (linear): HypLinear(
          in_features=16, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
    )
  )
  (dc): FermiDiracDecoder()
)
INFO:root:Total number of parameters: 59553
/workspace/anaconda3/envs/geo/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:370: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  "please use `get_last_lr()`.", UserWarning)
INFO:root:Epoch: 0005 lr: 0.01 train_loss: 1.8945 train_roc: 0.5963 train_ap: 0.6148 time: 0.4745s
INFO:root:Epoch: 0005 val_loss: 1.7454 val_roc: 0.6084 val_ap: 0.6094
INFO:root:Epoch: 0010 lr: 0.01 train_loss: 1.6425 train_roc: 0.5990 train_ap: 0.6055 time: 1.6264s
INFO:root:Epoch: 0010 val_loss: 1.6479 val_roc: 0.6474 val_ap: 0.6295
INFO:root:Epoch: 0015 lr: 0.01 train_loss: 1.5986 train_roc: 0.5902 train_ap: 0.5885 time: 1.6352s
INFO:root:Epoch: 0015 val_loss: 1.6723 val_roc: 0.5797 val_ap: 0.5780
INFO:root:Epoch: 0020 lr: 0.01 train_loss: 1.5094 train_roc: 0.6012 train_ap: 0.6010 time: 1.6196s
INFO:root:Epoch: 0020 val_loss: 1.5885 val_roc: 0.5820 val_ap: 0.5817
INFO:root:Epoch: 0025 lr: 0.01 train_loss: 1.4585 train_roc: 0.6353 train_ap: 0.6251 time: 1.6144s
INFO:root:Epoch: 0025 val_loss: 1.4364 val_roc: 0.6264 val_ap: 0.6302
INFO:root:Epoch: 0030 lr: 0.01 train_loss: 1.3399 train_roc: 0.6809 train_ap: 0.6865 time: 1.6205s
INFO:root:Epoch: 0030 val_loss: 1.3080 val_roc: 0.7047 val_ap: 0.7084
INFO:root:Epoch: 0035 lr: 0.01 train_loss: 1.2614 train_roc: 0.7382 train_ap: 0.7453 time: 1.6169s
INFO:root:Epoch: 0035 val_loss: 1.1934 val_roc: 0.7533 val_ap: 0.7627
INFO:root:Epoch: 0040 lr: 0.01 train_loss: 1.1351 train_roc: 0.7909 train_ap: 0.7907 time: 1.6370s
INFO:root:Epoch: 0040 val_loss: 1.0917 val_roc: 0.7989 val_ap: 0.8158
INFO:root:Epoch: 0045 lr: 0.01 train_loss: 1.2891 train_roc: 0.7524 train_ap: 0.7643 time: 1.5622s
INFO:root:Epoch: 0045 val_loss: 1.0030 val_roc: 0.8383 val_ap: 0.8514
INFO:root:Epoch: 0050 lr: 0.01 train_loss: 1.0237 train_roc: 0.8343 train_ap: 0.8422 time: 1.6061s
INFO:root:Epoch: 0050 val_loss: 0.9435 val_roc: 0.8612 val_ap: 0.8642
INFO:root:Epoch: 0055 lr: 0.01 train_loss: 0.9441 train_roc: 0.8676 train_ap: 0.8671 time: 1.6158s
INFO:root:Epoch: 0055 val_loss: 0.8885 val_roc: 0.8820 val_ap: 0.8803
INFO:root:Epoch: 0060 lr: 0.01 train_loss: 0.8691 train_roc: 0.8895 train_ap: 0.8808 time: 1.6004s
INFO:root:Epoch: 0060 val_loss: 0.8490 val_roc: 0.8952 val_ap: 0.8929
INFO:root:Epoch: 0065 lr: 0.01 train_loss: 0.8283 train_roc: 0.8983 train_ap: 0.8907 time: 1.5856s
INFO:root:Epoch: 0065 val_loss: 0.8342 val_roc: 0.9025 val_ap: 0.8991
INFO:root:Epoch: 0070 lr: 0.01 train_loss: 0.8236 train_roc: 0.8992 train_ap: 0.8952 time: 1.6462s
INFO:root:Epoch: 0070 val_loss: 0.8123 val_roc: 0.9110 val_ap: 0.9073
INFO:root:Epoch: 0075 lr: 0.01 train_loss: 0.7517 train_roc: 0.9173 train_ap: 0.9104 time: 1.5820s
INFO:root:Epoch: 0075 val_loss: 0.7731 val_roc: 0.9184 val_ap: 0.9146
INFO:root:Epoch: 0080 lr: 0.01 train_loss: 0.7838 train_roc: 0.9130 train_ap: 0.9073 time: 0.9995s
INFO:root:Epoch: 0080 val_loss: 0.7376 val_roc: 0.9250 val_ap: 0.9213
INFO:root:Epoch: 0085 lr: 0.01 train_loss: 0.7418 train_roc: 0.9254 train_ap: 0.9186 time: 0.4880s
INFO:root:Epoch: 0085 val_loss: 0.7078 val_roc: 0.9313 val_ap: 0.9281
INFO:root:Epoch: 0090 lr: 0.01 train_loss: 0.6907 train_roc: 0.9355 train_ap: 0.9283 time: 0.4828s
INFO:root:Epoch: 0090 val_loss: 0.6972 val_roc: 0.9349 val_ap: 0.9314
INFO:root:Epoch: 0095 lr: 0.01 train_loss: 0.6549 train_roc: 0.9437 train_ap: 0.9291 time: 0.4849s
INFO:root:Epoch: 0095 val_loss: 0.6979 val_roc: 0.9374 val_ap: 0.9334
INFO:root:Epoch: 0100 lr: 0.01 train_loss: 0.6642 train_roc: 0.9410 train_ap: 0.9305 time: 0.4791s
INFO:root:Epoch: 0100 val_loss: 0.6861 val_roc: 0.9410 val_ap: 0.9360
INFO:root:Epoch: 0105 lr: 0.01 train_loss: 0.7269 train_roc: 0.9273 train_ap: 0.9238 time: 0.4819s
INFO:root:Epoch: 0105 val_loss: 0.6685 val_roc: 0.9432 val_ap: 0.9376
INFO:root:Epoch: 0110 lr: 0.01 train_loss: 0.6769 train_roc: 0.9321 train_ap: 0.9160 time: 0.4990s
INFO:root:Epoch: 0110 val_loss: 0.6575 val_roc: 0.9440 val_ap: 0.9416
INFO:root:Epoch: 0115 lr: 0.01 train_loss: 0.6360 train_roc: 0.9445 train_ap: 0.9304 time: 0.5170s
INFO:root:Epoch: 0115 val_loss: 0.6420 val_roc: 0.9463 val_ap: 0.9429
INFO:root:Epoch: 0120 lr: 0.01 train_loss: 0.6120 train_roc: 0.9489 train_ap: 0.9394 time: 0.4806s
INFO:root:Epoch: 0120 val_loss: 0.6347 val_roc: 0.9472 val_ap: 0.9421
INFO:root:Epoch: 0125 lr: 0.01 train_loss: 0.5951 train_roc: 0.9524 train_ap: 0.9396 time: 0.4862s
INFO:root:Epoch: 0125 val_loss: 0.6463 val_roc: 0.9483 val_ap: 0.9409
INFO:root:Epoch: 0130 lr: 0.01 train_loss: 0.5782 train_roc: 0.9581 train_ap: 0.9458 time: 0.4909s
INFO:root:Epoch: 0130 val_loss: 0.6716 val_roc: 0.9463 val_ap: 0.9374
INFO:root:Epoch: 0135 lr: 0.01 train_loss: 0.5689 train_roc: 0.9583 train_ap: 0.9459 time: 0.4845s
INFO:root:Epoch: 0135 val_loss: 0.6577 val_roc: 0.9450 val_ap: 0.9350
INFO:root:Epoch: 0140 lr: 0.01 train_loss: 0.5600 train_roc: 0.9618 train_ap: 0.9494 time: 0.4892s
INFO:root:Epoch: 0140 val_loss: 0.6437 val_roc: 0.9446 val_ap: 0.9345
INFO:root:Epoch: 0145 lr: 0.01 train_loss: 0.5812 train_roc: 0.9538 train_ap: 0.9394 time: 0.4878s
INFO:root:Epoch: 0145 val_loss: 0.6434 val_roc: 0.9465 val_ap: 0.9387
INFO:root:Epoch: 0150 lr: 0.01 train_loss: 0.5559 train_roc: 0.9634 train_ap: 0.9513 time: 0.4833s
INFO:root:Epoch: 0150 val_loss: 0.6483 val_roc: 0.9485 val_ap: 0.9424
INFO:root:Epoch: 0155 lr: 0.01 train_loss: 0.5464 train_roc: 0.9621 train_ap: 0.9526 time: 0.4821s
INFO:root:Epoch: 0155 val_loss: 0.6568 val_roc: 0.9483 val_ap: 0.9408
INFO:root:Epoch: 0160 lr: 0.01 train_loss: 0.5196 train_roc: 0.9676 train_ap: 0.9608 time: 0.4795s
INFO:root:Epoch: 0160 val_loss: 0.6540 val_roc: 0.9489 val_ap: 0.9423
INFO:root:Epoch: 0165 lr: 0.01 train_loss: 0.5691 train_roc: 0.9609 train_ap: 0.9522 time: 0.4803s
INFO:root:Epoch: 0165 val_loss: 0.6464 val_roc: 0.9497 val_ap: 0.9448
INFO:root:Epoch: 0170 lr: 0.01 train_loss: 0.5710 train_roc: 0.9594 train_ap: 0.9484 time: 0.4816s
INFO:root:Epoch: 0170 val_loss: 0.6692 val_roc: 0.9501 val_ap: 0.9464
INFO:root:Epoch: 0175 lr: 0.01 train_loss: 0.5167 train_roc: 0.9661 train_ap: 0.9574 time: 0.4807s
INFO:root:Epoch: 0175 val_loss: 0.6690 val_roc: 0.9491 val_ap: 0.9466
INFO:root:Epoch: 0180 lr: 0.01 train_loss: 0.5831 train_roc: 0.9539 train_ap: 0.9411 time: 0.4847s
INFO:root:Epoch: 0180 val_loss: 0.6604 val_roc: 0.9467 val_ap: 0.9438
INFO:root:Epoch: 0185 lr: 0.01 train_loss: 0.5514 train_roc: 0.9594 train_ap: 0.9504 time: 0.4838s
INFO:root:Epoch: 0185 val_loss: 0.6694 val_roc: 0.9464 val_ap: 0.9452
INFO:root:Epoch: 0190 lr: 0.01 train_loss: 0.5462 train_roc: 0.9633 train_ap: 0.9534 time: 0.4812s
INFO:root:Epoch: 0190 val_loss: 0.6748 val_roc: 0.9481 val_ap: 0.9479
INFO:root:Epoch: 0195 lr: 0.01 train_loss: 0.5191 train_roc: 0.9644 train_ap: 0.9557 time: 0.4813s
INFO:root:Epoch: 0195 val_loss: 0.6941 val_roc: 0.9484 val_ap: 0.9484
INFO:root:Epoch: 0200 lr: 0.01 train_loss: 0.5341 train_roc: 0.9622 train_ap: 0.9514 time: 0.4845s
INFO:root:Epoch: 0200 val_loss: 0.6709 val_roc: 0.9486 val_ap: 0.9480
INFO:root:Epoch: 0205 lr: 0.01 train_loss: 0.5225 train_roc: 0.9643 train_ap: 0.9520 time: 0.4830s
INFO:root:Epoch: 0205 val_loss: 0.6749 val_roc: 0.9468 val_ap: 0.9461
INFO:root:Epoch: 0210 lr: 0.01 train_loss: 0.5252 train_roc: 0.9657 train_ap: 0.9547 time: 0.5263s
INFO:root:Epoch: 0210 val_loss: 0.6678 val_roc: 0.9465 val_ap: 0.9469
INFO:root:Epoch: 0215 lr: 0.01 train_loss: 0.5497 train_roc: 0.9653 train_ap: 0.9584 time: 0.4836s
INFO:root:Epoch: 0215 val_loss: 0.6593 val_roc: 0.9491 val_ap: 0.9504
INFO:root:Epoch: 0220 lr: 0.01 train_loss: 0.5442 train_roc: 0.9610 train_ap: 0.9520 time: 0.4775s
INFO:root:Epoch: 0220 val_loss: 0.6880 val_roc: 0.9487 val_ap: 0.9506
INFO:root:Epoch: 0225 lr: 0.01 train_loss: 0.5228 train_roc: 0.9654 train_ap: 0.9527 time: 0.4876s
INFO:root:Epoch: 0225 val_loss: 0.7214 val_roc: 0.9456 val_ap: 0.9467
INFO:root:Epoch: 0230 lr: 0.01 train_loss: 0.5299 train_roc: 0.9645 train_ap: 0.9564 time: 0.4849s
INFO:root:Epoch: 0230 val_loss: 0.7268 val_roc: 0.9429 val_ap: 0.9429
INFO:root:Epoch: 0235 lr: 0.01 train_loss: 0.5540 train_roc: 0.9612 train_ap: 0.9533 time: 0.4852s
INFO:root:Epoch: 0235 val_loss: 0.7118 val_roc: 0.9454 val_ap: 0.9464
INFO:root:Epoch: 0240 lr: 0.01 train_loss: 0.5354 train_roc: 0.9590 train_ap: 0.9450 time: 0.4812s
INFO:root:Epoch: 0240 val_loss: 0.6883 val_roc: 0.9494 val_ap: 0.9510
INFO:root:Epoch: 0245 lr: 0.01 train_loss: 0.5210 train_roc: 0.9680 train_ap: 0.9603 time: 0.4809s
INFO:root:Epoch: 0245 val_loss: 0.6711 val_roc: 0.9511 val_ap: 0.9528
INFO:root:Epoch: 0250 lr: 0.01 train_loss: 0.5288 train_roc: 0.9642 train_ap: 0.9542 time: 0.4784s
INFO:root:Epoch: 0250 val_loss: 0.6706 val_roc: 0.9501 val_ap: 0.9522
INFO:root:Epoch: 0255 lr: 0.01 train_loss: 0.5532 train_roc: 0.9595 train_ap: 0.9483 time: 0.4867s
INFO:root:Epoch: 0255 val_loss: 0.6839 val_roc: 0.9496 val_ap: 0.9514
INFO:root:Epoch: 0260 lr: 0.01 train_loss: 0.5277 train_roc: 0.9659 train_ap: 0.9554 time: 0.4890s
INFO:root:Epoch: 0260 val_loss: 0.6985 val_roc: 0.9492 val_ap: 0.9506
INFO:root:Epoch: 0265 lr: 0.01 train_loss: 0.4897 train_roc: 0.9703 train_ap: 0.9613 time: 0.4888s
INFO:root:Epoch: 0265 val_loss: 0.7209 val_roc: 0.9474 val_ap: 0.9496
INFO:root:Epoch: 0270 lr: 0.01 train_loss: 0.5405 train_roc: 0.9632 train_ap: 0.9531 time: 0.4790s
INFO:root:Epoch: 0270 val_loss: 0.7083 val_roc: 0.9442 val_ap: 0.9461
INFO:root:Epoch: 0275 lr: 0.01 train_loss: 0.5000 train_roc: 0.9704 train_ap: 0.9632 time: 0.4812s
INFO:root:Epoch: 0275 val_loss: 0.7209 val_roc: 0.9456 val_ap: 0.9446
INFO:root:Epoch: 0280 lr: 0.01 train_loss: 0.5537 train_roc: 0.9634 train_ap: 0.9517 time: 0.4838s
INFO:root:Epoch: 0280 val_loss: 0.7153 val_roc: 0.9462 val_ap: 0.9444
INFO:root:Epoch: 0285 lr: 0.01 train_loss: 0.4965 train_roc: 0.9659 train_ap: 0.9547 time: 0.4843s
INFO:root:Epoch: 0285 val_loss: 0.6731 val_roc: 0.9474 val_ap: 0.9425
INFO:root:Epoch: 0290 lr: 0.01 train_loss: 0.5097 train_roc: 0.9670 train_ap: 0.9587 time: 0.4863s
INFO:root:Epoch: 0290 val_loss: 0.6695 val_roc: 0.9473 val_ap: 0.9373
INFO:root:Epoch: 0295 lr: 0.01 train_loss: 0.5130 train_roc: 0.9656 train_ap: 0.9532 time: 0.4837s
INFO:root:Epoch: 0295 val_loss: 0.7066 val_roc: 0.9467 val_ap: 0.9419
INFO:root:Epoch: 0300 lr: 0.01 train_loss: 0.4941 train_roc: 0.9694 train_ap: 0.9610 time: 0.4805s
INFO:root:Epoch: 0300 val_loss: 0.7307 val_roc: 0.9462 val_ap: 0.9408
INFO:root:Epoch: 0305 lr: 0.01 train_loss: 0.4826 train_roc: 0.9704 train_ap: 0.9584 time: 0.4797s
INFO:root:Epoch: 0305 val_loss: 0.7208 val_roc: 0.9483 val_ap: 0.9456
INFO:root:Epoch: 0310 lr: 0.01 train_loss: 0.4882 train_roc: 0.9698 train_ap: 0.9575 time: 0.4889s
INFO:root:Epoch: 0310 val_loss: 0.7144 val_roc: 0.9457 val_ap: 0.9460
INFO:root:Epoch: 0315 lr: 0.01 train_loss: 0.4905 train_roc: 0.9682 train_ap: 0.9574 time: 0.4827s
INFO:root:Epoch: 0315 val_loss: 0.7148 val_roc: 0.9436 val_ap: 0.9441
INFO:root:Epoch: 0320 lr: 0.01 train_loss: 0.5025 train_roc: 0.9683 train_ap: 0.9583 time: 0.4788s
INFO:root:Epoch: 0320 val_loss: 0.7182 val_roc: 0.9450 val_ap: 0.9448
INFO:root:Epoch: 0325 lr: 0.01 train_loss: 0.4719 train_roc: 0.9739 train_ap: 0.9650 time: 0.4821s
INFO:root:Epoch: 0325 val_loss: 0.7167 val_roc: 0.9461 val_ap: 0.9458
INFO:root:Epoch: 0330 lr: 0.01 train_loss: 0.4989 train_roc: 0.9679 train_ap: 0.9565 time: 0.4784s
INFO:root:Epoch: 0330 val_loss: 0.7197 val_roc: 0.9467 val_ap: 0.9463
INFO:root:Epoch: 0335 lr: 0.01 train_loss: 0.4921 train_roc: 0.9680 train_ap: 0.9564 time: 0.4826s
INFO:root:Epoch: 0335 val_loss: 0.7358 val_roc: 0.9474 val_ap: 0.9462
INFO:root:Epoch: 0340 lr: 0.01 train_loss: 0.5002 train_roc: 0.9703 train_ap: 0.9602 time: 0.4877s
INFO:root:Epoch: 0340 val_loss: 0.7265 val_roc: 0.9464 val_ap: 0.9450
INFO:root:Epoch: 0345 lr: 0.01 train_loss: 0.4723 train_roc: 0.9715 train_ap: 0.9603 time: 0.4879s
INFO:root:Epoch: 0345 val_loss: 0.7084 val_roc: 0.9441 val_ap: 0.9471
INFO:root:Early stopping
INFO:root:Optimization Finished!
INFO:root:Total time elapsed: 372.9891s
INFO:root:Val set results: val_loss: 0.6711 val_roc: 0.9511 val_ap: 0.9528
INFO:root:Test set results: test_loss: 0.7222 test_roc: 0.9391 test_ap: 0.9275
INFO:root:Saved model in /workspace/xiongbo/hgcn/logs/lp/2021_5_8/32
