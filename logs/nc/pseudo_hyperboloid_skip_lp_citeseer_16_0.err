INFO:root:Using: cuda:0
INFO:root:Using seed 1234.
INFO:root:LPModel(
  (encoder): HGCN(
    (layers): Sequential(
      (0): HyperbolicGraphConvolution(
        (linear): HypLinear(
          in_features=3704, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (agg): HypAgg(
          c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
      (1): HyperbolicGraphConvolution(
        (linear): HypLinear(
          in_features=16, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (agg): HypAgg(
          c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
    )
  )
  (dc): FermiDiracDecoder()
)
INFO:root:Total number of parameters: 59555
/workspace/anaconda3/envs/geo/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:370: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  "please use `get_last_lr()`.", UserWarning)
INFO:root:Epoch: 0005 lr: 0.01 train_loss: 1.7780 train_roc: 0.8487 train_ap: 0.8464 time: 0.7377s
INFO:root:Epoch: 0005 val_loss: 1.7467 val_roc: 0.7966 val_ap: 0.8236
INFO:root:Epoch: 0010 lr: 0.01 train_loss: 1.5618 train_roc: 0.9139 train_ap: 0.9057 time: 0.7530s
INFO:root:Epoch: 0010 val_loss: 1.5038 val_roc: 0.8257 val_ap: 0.8353
INFO:root:Epoch: 0015 lr: 0.01 train_loss: 1.3472 train_roc: 0.9310 train_ap: 0.9193 time: 0.7799s
INFO:root:Epoch: 0015 val_loss: 1.3302 val_roc: 0.8108 val_ap: 0.8090
INFO:root:Epoch: 0020 lr: 0.01 train_loss: 1.2612 train_roc: 0.9315 train_ap: 0.9238 time: 0.7683s
INFO:root:Epoch: 0020 val_loss: 1.2720 val_roc: 0.8247 val_ap: 0.8136
INFO:root:Epoch: 0025 lr: 0.01 train_loss: 1.1374 train_roc: 0.9368 train_ap: 0.9231 time: 0.7753s
INFO:root:Epoch: 0025 val_loss: 1.2328 val_roc: 0.8339 val_ap: 0.8338
INFO:root:Epoch: 0030 lr: 0.01 train_loss: 1.2108 train_roc: 0.9314 train_ap: 0.9228 time: 0.7775s
INFO:root:Epoch: 0030 val_loss: 1.1985 val_roc: 0.8348 val_ap: 0.8362
INFO:root:Epoch: 0035 lr: 0.01 train_loss: 1.1475 train_roc: 0.9334 train_ap: 0.9272 time: 0.7574s
INFO:root:Epoch: 0035 val_loss: 1.1556 val_roc: 0.8409 val_ap: 0.8427
INFO:root:Epoch: 0040 lr: 0.01 train_loss: 0.9608 train_roc: 0.9409 train_ap: 0.9276 time: 0.7917s
INFO:root:Epoch: 0040 val_loss: 1.1216 val_roc: 0.8503 val_ap: 0.8578
INFO:root:Epoch: 0045 lr: 0.01 train_loss: 0.9929 train_roc: 0.9394 train_ap: 0.9287 time: 0.7758s
INFO:root:Epoch: 0045 val_loss: 1.0771 val_roc: 0.8641 val_ap: 0.8711
INFO:root:Epoch: 0050 lr: 0.01 train_loss: 0.9517 train_roc: 0.9431 train_ap: 0.9354 time: 0.7800s
INFO:root:Epoch: 0050 val_loss: 1.0033 val_roc: 0.8789 val_ap: 0.8820
INFO:root:Epoch: 0055 lr: 0.01 train_loss: 0.8346 train_roc: 0.9481 train_ap: 0.9390 time: 0.7560s
INFO:root:Epoch: 0055 val_loss: 0.9392 val_roc: 0.8808 val_ap: 0.8829
INFO:root:Epoch: 0060 lr: 0.01 train_loss: 0.7637 train_roc: 0.9581 train_ap: 0.9488 time: 0.7594s
INFO:root:Epoch: 0060 val_loss: 0.8667 val_roc: 0.9032 val_ap: 0.9021
INFO:root:Epoch: 0065 lr: 0.01 train_loss: 0.7577 train_roc: 0.9581 train_ap: 0.9469 time: 0.7755s
INFO:root:Epoch: 0065 val_loss: 0.8146 val_roc: 0.9169 val_ap: 0.9205
INFO:root:Epoch: 0070 lr: 0.01 train_loss: 0.6336 train_roc: 0.9677 train_ap: 0.9615 time: 0.7953s
INFO:root:Epoch: 0070 val_loss: 0.7593 val_roc: 0.9236 val_ap: 0.9228
INFO:root:Epoch: 0075 lr: 0.01 train_loss: 0.5992 train_roc: 0.9679 train_ap: 0.9633 time: 0.7654s
INFO:root:Epoch: 0075 val_loss: 0.7245 val_roc: 0.9316 val_ap: 0.9343
INFO:root:Epoch: 0080 lr: 0.01 train_loss: 0.5557 train_roc: 0.9714 train_ap: 0.9635 time: 0.7844s
INFO:root:Epoch: 0080 val_loss: 0.6970 val_roc: 0.9372 val_ap: 0.9403
INFO:root:Epoch: 0085 lr: 0.01 train_loss: 0.5454 train_roc: 0.9730 train_ap: 0.9658 time: 0.7697s
INFO:root:Epoch: 0085 val_loss: 0.6963 val_roc: 0.9361 val_ap: 0.9405
INFO:root:Epoch: 0090 lr: 0.01 train_loss: 0.5335 train_roc: 0.9780 train_ap: 0.9728 time: 0.7807s
INFO:root:Epoch: 0090 val_loss: 0.6582 val_roc: 0.9464 val_ap: 0.9506
INFO:root:Epoch: 0095 lr: 0.01 train_loss: 0.5146 train_roc: 0.9803 train_ap: 0.9730 time: 0.7587s
INFO:root:Epoch: 0095 val_loss: 0.6572 val_roc: 0.9465 val_ap: 0.9502
INFO:root:Epoch: 0100 lr: 0.01 train_loss: 0.5025 train_roc: 0.9795 train_ap: 0.9720 time: 0.7741s
INFO:root:Epoch: 0100 val_loss: 0.6514 val_roc: 0.9475 val_ap: 0.9504
INFO:root:Epoch: 0105 lr: 0.01 train_loss: 0.4967 train_roc: 0.9844 train_ap: 0.9801 time: 0.7741s
INFO:root:Epoch: 0105 val_loss: 0.6421 val_roc: 0.9507 val_ap: 0.9541
INFO:root:Epoch: 0110 lr: 0.01 train_loss: 0.4913 train_roc: 0.9832 train_ap: 0.9772 time: 0.7799s
INFO:root:Epoch: 0110 val_loss: 0.6456 val_roc: 0.9499 val_ap: 0.9534
INFO:root:Epoch: 0115 lr: 0.01 train_loss: 0.4633 train_roc: 0.9832 train_ap: 0.9740 time: 0.7729s
INFO:root:Epoch: 0115 val_loss: 0.6460 val_roc: 0.9508 val_ap: 0.9541
INFO:root:Epoch: 0120 lr: 0.01 train_loss: 0.4751 train_roc: 0.9849 train_ap: 0.9799 time: 0.7804s
INFO:root:Epoch: 0120 val_loss: 0.6417 val_roc: 0.9510 val_ap: 0.9540
INFO:root:Epoch: 0125 lr: 0.01 train_loss: 0.4597 train_roc: 0.9861 train_ap: 0.9791 time: 0.7630s
INFO:root:Epoch: 0125 val_loss: 0.6297 val_roc: 0.9534 val_ap: 0.9565
INFO:root:Epoch: 0130 lr: 0.01 train_loss: 0.4466 train_roc: 0.9868 train_ap: 0.9800 time: 0.7596s
INFO:root:Epoch: 0130 val_loss: 0.6223 val_roc: 0.9546 val_ap: 0.9575
INFO:root:Epoch: 0135 lr: 0.01 train_loss: 0.4515 train_roc: 0.9853 train_ap: 0.9770 time: 0.7767s
INFO:root:Epoch: 0135 val_loss: 0.6136 val_roc: 0.9554 val_ap: 0.9574
INFO:root:Epoch: 0140 lr: 0.01 train_loss: 0.4353 train_roc: 0.9866 train_ap: 0.9777 time: 0.7715s
INFO:root:Epoch: 0140 val_loss: 0.6193 val_roc: 0.9541 val_ap: 0.9554
INFO:root:Epoch: 0145 lr: 0.01 train_loss: 0.4512 train_roc: 0.9855 train_ap: 0.9762 time: 0.7687s
INFO:root:Epoch: 0145 val_loss: 0.6226 val_roc: 0.9559 val_ap: 0.9596
INFO:root:Epoch: 0150 lr: 0.01 train_loss: 0.4320 train_roc: 0.9825 train_ap: 0.9711 time: 0.7859s
INFO:root:Epoch: 0150 val_loss: 0.6177 val_roc: 0.9558 val_ap: 0.9581
INFO:root:Epoch: 0155 lr: 0.01 train_loss: 0.4202 train_roc: 0.9892 train_ap: 0.9848 time: 0.7638s
INFO:root:Epoch: 0155 val_loss: 0.6175 val_roc: 0.9529 val_ap: 0.9509
INFO:root:Epoch: 0160 lr: 0.01 train_loss: 0.4249 train_roc: 0.9899 train_ap: 0.9875 time: 0.7611s
INFO:root:Epoch: 0160 val_loss: 0.6066 val_roc: 0.9594 val_ap: 0.9622
INFO:root:Epoch: 0165 lr: 0.01 train_loss: 0.4233 train_roc: 0.9893 train_ap: 0.9848 time: 0.7767s
INFO:root:Epoch: 0165 val_loss: 0.6034 val_roc: 0.9598 val_ap: 0.9627
INFO:root:Epoch: 0170 lr: 0.01 train_loss: 0.4091 train_roc: 0.9889 train_ap: 0.9816 time: 0.7596s
INFO:root:Epoch: 0170 val_loss: 0.6080 val_roc: 0.9598 val_ap: 0.9632
INFO:root:Epoch: 0175 lr: 0.01 train_loss: 0.4084 train_roc: 0.9897 train_ap: 0.9850 time: 0.7626s
INFO:root:Epoch: 0175 val_loss: 0.6126 val_roc: 0.9600 val_ap: 0.9645
INFO:root:Epoch: 0180 lr: 0.01 train_loss: 0.4076 train_roc: 0.9863 train_ap: 0.9775 time: 0.7664s
INFO:root:Epoch: 0180 val_loss: 0.6074 val_roc: 0.9615 val_ap: 0.9652
INFO:root:Epoch: 0185 lr: 0.01 train_loss: 0.4056 train_roc: 0.9886 train_ap: 0.9840 time: 0.7578s
INFO:root:Epoch: 0185 val_loss: 0.5856 val_roc: 0.9650 val_ap: 0.9675
INFO:root:Epoch: 0190 lr: 0.01 train_loss: 0.3930 train_roc: 0.9908 train_ap: 0.9853 time: 0.7645s
INFO:root:Epoch: 0190 val_loss: 0.5877 val_roc: 0.9623 val_ap: 0.9613
INFO:root:Epoch: 0195 lr: 0.01 train_loss: 0.3969 train_roc: 0.9910 train_ap: 0.9884 time: 0.7555s
INFO:root:Epoch: 0195 val_loss: 0.5942 val_roc: 0.9641 val_ap: 0.9660
INFO:root:Epoch: 0200 lr: 0.01 train_loss: 0.3948 train_roc: 0.9880 train_ap: 0.9821 time: 0.7806s
INFO:root:Epoch: 0200 val_loss: 0.6105 val_roc: 0.9596 val_ap: 0.9584
INFO:root:Epoch: 0205 lr: 0.01 train_loss: 0.3883 train_roc: 0.9885 train_ap: 0.9792 time: 0.7618s
INFO:root:Epoch: 0205 val_loss: 0.6269 val_roc: 0.9578 val_ap: 0.9572
INFO:root:Epoch: 0210 lr: 0.01 train_loss: 0.3769 train_roc: 0.9917 train_ap: 0.9851 time: 0.7635s
INFO:root:Epoch: 0210 val_loss: 0.6226 val_roc: 0.9589 val_ap: 0.9584
INFO:root:Epoch: 0215 lr: 0.01 train_loss: 0.3963 train_roc: 0.9929 train_ap: 0.9909 time: 0.7636s
INFO:root:Epoch: 0215 val_loss: 0.6363 val_roc: 0.9594 val_ap: 0.9607
INFO:root:Epoch: 0220 lr: 0.01 train_loss: 0.4005 train_roc: 0.9898 train_ap: 0.9846 time: 0.7579s
INFO:root:Epoch: 0220 val_loss: 0.6235 val_roc: 0.9614 val_ap: 0.9640
INFO:root:Epoch: 0225 lr: 0.01 train_loss: 0.3939 train_roc: 0.9898 train_ap: 0.9829 time: 0.7844s
INFO:root:Epoch: 0225 val_loss: 0.6215 val_roc: 0.9587 val_ap: 0.9610
INFO:root:Epoch: 0230 lr: 0.01 train_loss: 0.3846 train_roc: 0.9921 train_ap: 0.9886 time: 0.7794s
INFO:root:Epoch: 0230 val_loss: 0.6346 val_roc: 0.9591 val_ap: 0.9630
INFO:root:Epoch: 0235 lr: 0.01 train_loss: 0.3850 train_roc: 0.9900 train_ap: 0.9838 time: 0.7723s
INFO:root:Epoch: 0235 val_loss: 0.6477 val_roc: 0.9577 val_ap: 0.9618
INFO:root:Epoch: 0240 lr: 0.01 train_loss: 0.3734 train_roc: 0.9930 train_ap: 0.9867 time: 0.7796s
INFO:root:Epoch: 0240 val_loss: 0.6459 val_roc: 0.9578 val_ap: 0.9624
INFO:root:Epoch: 0245 lr: 0.01 train_loss: 0.3792 train_roc: 0.9914 train_ap: 0.9868 time: 0.7628s
INFO:root:Epoch: 0245 val_loss: 0.6538 val_roc: 0.9583 val_ap: 0.9627
INFO:root:Epoch: 0250 lr: 0.01 train_loss: 0.3835 train_roc: 0.9912 train_ap: 0.9872 time: 0.7578s
INFO:root:Epoch: 0250 val_loss: 0.6463 val_roc: 0.9562 val_ap: 0.9578
INFO:root:Epoch: 0255 lr: 0.01 train_loss: 0.3815 train_roc: 0.9900 train_ap: 0.9834 time: 0.7684s
INFO:root:Epoch: 0255 val_loss: 0.6362 val_roc: 0.9605 val_ap: 0.9639
INFO:root:Epoch: 0260 lr: 0.01 train_loss: 0.3789 train_roc: 0.9908 train_ap: 0.9835 time: 0.7701s
INFO:root:Epoch: 0260 val_loss: 0.6322 val_roc: 0.9587 val_ap: 0.9589
INFO:root:Epoch: 0265 lr: 0.01 train_loss: 0.3703 train_roc: 0.9916 train_ap: 0.9868 time: 0.7796s
INFO:root:Epoch: 0265 val_loss: 0.6369 val_roc: 0.9600 val_ap: 0.9627
INFO:root:Epoch: 0270 lr: 0.01 train_loss: 0.3728 train_roc: 0.9918 train_ap: 0.9876 time: 0.7863s
INFO:root:Epoch: 0270 val_loss: 0.6408 val_roc: 0.9602 val_ap: 0.9630
INFO:root:Epoch: 0275 lr: 0.01 train_loss: 0.3609 train_roc: 0.9910 train_ap: 0.9856 time: 0.7601s
INFO:root:Epoch: 0275 val_loss: 0.6411 val_roc: 0.9581 val_ap: 0.9575
INFO:root:Epoch: 0280 lr: 0.01 train_loss: 0.3798 train_roc: 0.9877 train_ap: 0.9761 time: 0.7814s
INFO:root:Epoch: 0280 val_loss: 0.6563 val_roc: 0.9552 val_ap: 0.9518
INFO:root:Epoch: 0285 lr: 0.01 train_loss: 0.3796 train_roc: 0.9915 train_ap: 0.9870 time: 0.7613s
INFO:root:Epoch: 0285 val_loss: 0.6595 val_roc: 0.9589 val_ap: 0.9633
INFO:root:Early stopping
INFO:root:Optimization Finished!
INFO:root:Total time elapsed: 354.8174s
INFO:root:Val set results: val_loss: 0.5895 val_roc: 0.9661 val_ap: 0.9699
INFO:root:Test set results: test_loss: 0.6167 test_roc: 0.9551 test_ap: 0.9472
INFO:root:Saved model in /workspace/xiongbo/hgcn/logs/lp/2021_5_3/0
