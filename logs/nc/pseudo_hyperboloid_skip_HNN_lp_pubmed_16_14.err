INFO:root:Using: cuda:0
INFO:root:Using seed 1234.
INFO:root:LPModel(
  (encoder): HNN(
    (layers): Sequential(
      (0): HNNLayer(
        (linear): HypLinear(
          in_features=501, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
      (1): HNNLayer(
        (linear): HypLinear(
          in_features=16, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
    )
  )
  (dc): FermiDiracDecoder()
)
INFO:root:Total number of parameters: 8305
/workspace/anaconda3/envs/geo/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:370: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  "please use `get_last_lr()`.", UserWarning)
INFO:root:Epoch: 0005 lr: 0.01 train_loss: 1.8831 train_roc: 0.5653 train_ap: 0.5649 time: 2.3766s
INFO:root:Epoch: 0005 val_loss: 1.8403 val_roc: 0.5855 val_ap: 0.5784
INFO:root:Epoch: 0010 lr: 0.01 train_loss: 1.7129 train_roc: 0.6049 train_ap: 0.6091 time: 2.3142s
INFO:root:Epoch: 0010 val_loss: 1.6232 val_roc: 0.6046 val_ap: 0.6064
INFO:root:Epoch: 0015 lr: 0.01 train_loss: 1.5315 train_roc: 0.6191 train_ap: 0.6185 time: 2.3409s
INFO:root:Epoch: 0015 val_loss: 1.4663 val_roc: 0.6397 val_ap: 0.6320
INFO:root:Epoch: 0020 lr: 0.01 train_loss: 1.4041 train_roc: 0.6444 train_ap: 0.6436 time: 2.4161s
INFO:root:Epoch: 0020 val_loss: 1.3271 val_roc: 0.6804 val_ap: 0.6749
INFO:root:Epoch: 0025 lr: 0.01 train_loss: 1.3478 train_roc: 0.6586 train_ap: 0.6612 time: 2.3344s
INFO:root:Epoch: 0025 val_loss: 1.2417 val_roc: 0.7326 val_ap: 0.7226
INFO:root:Epoch: 0030 lr: 0.01 train_loss: 1.2323 train_roc: 0.7311 train_ap: 0.7302 time: 2.3540s
INFO:root:Epoch: 0030 val_loss: 1.1418 val_roc: 0.7828 val_ap: 0.7760
INFO:root:Epoch: 0035 lr: 0.01 train_loss: 1.1606 train_roc: 0.7725 train_ap: 0.7703 time: 2.2037s
INFO:root:Epoch: 0035 val_loss: 1.0468 val_roc: 0.8226 val_ap: 0.8143
INFO:root:Epoch: 0040 lr: 0.01 train_loss: 1.1165 train_roc: 0.7943 train_ap: 0.7871 time: 0.7081s
INFO:root:Epoch: 0040 val_loss: 1.0032 val_roc: 0.8426 val_ap: 0.8337
INFO:root:Epoch: 0045 lr: 0.01 train_loss: 1.1013 train_roc: 0.8061 train_ap: 0.8001 time: 0.7040s
INFO:root:Epoch: 0045 val_loss: 0.9503 val_roc: 0.8606 val_ap: 0.8551
INFO:root:Epoch: 0050 lr: 0.01 train_loss: 1.0154 train_roc: 0.8365 train_ap: 0.8325 time: 0.7095s
INFO:root:Epoch: 0050 val_loss: 0.9208 val_roc: 0.8714 val_ap: 0.8680
INFO:root:Epoch: 0055 lr: 0.01 train_loss: 1.0363 train_roc: 0.8265 train_ap: 0.8225 time: 0.7095s
INFO:root:Epoch: 0055 val_loss: 0.8926 val_roc: 0.8790 val_ap: 0.8738
INFO:root:Epoch: 0060 lr: 0.01 train_loss: 1.0027 train_roc: 0.8394 train_ap: 0.8316 time: 0.7026s
INFO:root:Epoch: 0060 val_loss: 0.8401 val_roc: 0.8935 val_ap: 0.8857
INFO:root:Epoch: 0065 lr: 0.01 train_loss: 0.9879 train_roc: 0.8484 train_ap: 0.8411 time: 0.7147s
INFO:root:Epoch: 0065 val_loss: 0.8017 val_roc: 0.9031 val_ap: 0.8931
INFO:root:Epoch: 0070 lr: 0.01 train_loss: 0.9651 train_roc: 0.8638 train_ap: 0.8528 time: 0.7154s
INFO:root:Epoch: 0070 val_loss: 0.7863 val_roc: 0.9069 val_ap: 0.8961
INFO:root:Epoch: 0075 lr: 0.01 train_loss: 0.9268 train_roc: 0.8638 train_ap: 0.8488 time: 0.7159s
INFO:root:Epoch: 0075 val_loss: 0.7831 val_roc: 0.9080 val_ap: 0.8981
INFO:root:Epoch: 0080 lr: 0.01 train_loss: 0.9209 train_roc: 0.8699 train_ap: 0.8592 time: 0.7018s
INFO:root:Epoch: 0080 val_loss: 0.7691 val_roc: 0.9117 val_ap: 0.9013
INFO:root:Epoch: 0085 lr: 0.01 train_loss: 0.9218 train_roc: 0.8689 train_ap: 0.8584 time: 0.7196s
INFO:root:Epoch: 0085 val_loss: 0.7585 val_roc: 0.9144 val_ap: 0.9030
INFO:root:Epoch: 0090 lr: 0.01 train_loss: 0.8926 train_roc: 0.8762 train_ap: 0.8636 time: 0.7131s
INFO:root:Epoch: 0090 val_loss: 0.7610 val_roc: 0.9157 val_ap: 0.9042
INFO:root:Epoch: 0095 lr: 0.01 train_loss: 0.8878 train_roc: 0.8808 train_ap: 0.8682 time: 0.7095s
INFO:root:Epoch: 0095 val_loss: 0.7646 val_roc: 0.9164 val_ap: 0.9048
INFO:root:Epoch: 0100 lr: 0.01 train_loss: 0.9072 train_roc: 0.8819 train_ap: 0.8716 time: 0.7113s
INFO:root:Epoch: 0100 val_loss: 0.7565 val_roc: 0.9156 val_ap: 0.9040
INFO:root:Epoch: 0105 lr: 0.01 train_loss: 0.8477 train_roc: 0.8890 train_ap: 0.8720 time: 0.7134s
INFO:root:Epoch: 0105 val_loss: 0.7516 val_roc: 0.9156 val_ap: 0.9038
INFO:root:Epoch: 0110 lr: 0.01 train_loss: 0.8883 train_roc: 0.8796 train_ap: 0.8642 time: 0.7527s
INFO:root:Epoch: 0110 val_loss: 0.7471 val_roc: 0.9177 val_ap: 0.9061
INFO:root:Epoch: 0115 lr: 0.01 train_loss: 0.8663 train_roc: 0.8848 train_ap: 0.8725 time: 0.7148s
INFO:root:Epoch: 0115 val_loss: 0.7435 val_roc: 0.9194 val_ap: 0.9073
INFO:root:Epoch: 0120 lr: 0.01 train_loss: 0.8944 train_roc: 0.8832 train_ap: 0.8729 time: 0.7123s
INFO:root:Epoch: 0120 val_loss: 0.7332 val_roc: 0.9207 val_ap: 0.9080
INFO:root:Epoch: 0125 lr: 0.01 train_loss: 0.8519 train_roc: 0.8890 train_ap: 0.8743 time: 0.7077s
INFO:root:Epoch: 0125 val_loss: 0.7288 val_roc: 0.9201 val_ap: 0.9071
INFO:root:Epoch: 0130 lr: 0.01 train_loss: 0.8626 train_roc: 0.8887 train_ap: 0.8732 time: 0.7068s
INFO:root:Epoch: 0130 val_loss: 0.7320 val_roc: 0.9197 val_ap: 0.9076
INFO:root:Epoch: 0135 lr: 0.01 train_loss: 0.8680 train_roc: 0.8860 train_ap: 0.8715 time: 0.7041s
INFO:root:Epoch: 0135 val_loss: 0.7406 val_roc: 0.9215 val_ap: 0.9099
INFO:root:Epoch: 0140 lr: 0.01 train_loss: 0.8493 train_roc: 0.8940 train_ap: 0.8774 time: 0.7119s
INFO:root:Epoch: 0140 val_loss: 0.7461 val_roc: 0.9212 val_ap: 0.9098
INFO:root:Epoch: 0145 lr: 0.01 train_loss: 0.8258 train_roc: 0.8961 train_ap: 0.8818 time: 0.7064s
INFO:root:Epoch: 0145 val_loss: 0.7321 val_roc: 0.9218 val_ap: 0.9105
INFO:root:Epoch: 0150 lr: 0.01 train_loss: 0.8528 train_roc: 0.8911 train_ap: 0.8801 time: 0.7314s
INFO:root:Epoch: 0150 val_loss: 0.7245 val_roc: 0.9224 val_ap: 0.9109
INFO:root:Epoch: 0155 lr: 0.01 train_loss: 0.8505 train_roc: 0.8907 train_ap: 0.8793 time: 0.7098s
INFO:root:Epoch: 0155 val_loss: 0.7207 val_roc: 0.9223 val_ap: 0.9105
INFO:root:Epoch: 0160 lr: 0.01 train_loss: 0.8380 train_roc: 0.8941 train_ap: 0.8799 time: 0.7094s
INFO:root:Epoch: 0160 val_loss: 0.7237 val_roc: 0.9234 val_ap: 0.9118
INFO:root:Epoch: 0165 lr: 0.01 train_loss: 0.8608 train_roc: 0.8860 train_ap: 0.8715 time: 0.7046s
INFO:root:Epoch: 0165 val_loss: 0.7181 val_roc: 0.9243 val_ap: 0.9135
INFO:root:Epoch: 0170 lr: 0.01 train_loss: 0.8785 train_roc: 0.8850 train_ap: 0.8747 time: 0.7097s
INFO:root:Epoch: 0170 val_loss: 0.7127 val_roc: 0.9254 val_ap: 0.9142
INFO:root:Epoch: 0175 lr: 0.01 train_loss: 0.8201 train_roc: 0.8956 train_ap: 0.8765 time: 0.7146s
INFO:root:Epoch: 0175 val_loss: 0.7207 val_roc: 0.9256 val_ap: 0.9135
INFO:root:Epoch: 0180 lr: 0.01 train_loss: 0.8609 train_roc: 0.8873 train_ap: 0.8759 time: 0.7133s
INFO:root:Epoch: 0180 val_loss: 0.7134 val_roc: 0.9255 val_ap: 0.9122
INFO:root:Epoch: 0185 lr: 0.01 train_loss: 0.8182 train_roc: 0.9034 train_ap: 0.8886 time: 0.7149s
INFO:root:Epoch: 0185 val_loss: 0.7076 val_roc: 0.9261 val_ap: 0.9131
INFO:root:Epoch: 0190 lr: 0.01 train_loss: 0.8088 train_roc: 0.9024 train_ap: 0.8876 time: 0.7121s
INFO:root:Epoch: 0190 val_loss: 0.7167 val_roc: 0.9265 val_ap: 0.9139
INFO:root:Epoch: 0195 lr: 0.01 train_loss: 0.8247 train_roc: 0.8994 train_ap: 0.8863 time: 2.2049s
INFO:root:Epoch: 0195 val_loss: 0.7102 val_roc: 0.9264 val_ap: 0.9144
INFO:root:Epoch: 0200 lr: 0.01 train_loss: 0.8307 train_roc: 0.8956 train_ap: 0.8823 time: 2.1787s
INFO:root:Epoch: 0200 val_loss: 0.7130 val_roc: 0.9257 val_ap: 0.9141
INFO:root:Epoch: 0205 lr: 0.01 train_loss: 0.8257 train_roc: 0.9022 train_ap: 0.8859 time: 2.2466s
INFO:root:Epoch: 0205 val_loss: 0.7172 val_roc: 0.9263 val_ap: 0.9142
INFO:root:Epoch: 0210 lr: 0.01 train_loss: 0.8258 train_roc: 0.8971 train_ap: 0.8843 time: 2.2214s
INFO:root:Epoch: 0210 val_loss: 0.7130 val_roc: 0.9261 val_ap: 0.9132
INFO:root:Epoch: 0215 lr: 0.01 train_loss: 0.8616 train_roc: 0.8901 train_ap: 0.8792 time: 2.2911s
INFO:root:Epoch: 0215 val_loss: 0.7145 val_roc: 0.9262 val_ap: 0.9131
INFO:root:Epoch: 0220 lr: 0.01 train_loss: 0.8004 train_roc: 0.9085 train_ap: 0.8935 time: 2.2296s
INFO:root:Epoch: 0220 val_loss: 0.7151 val_roc: 0.9260 val_ap: 0.9134
INFO:root:Epoch: 0225 lr: 0.01 train_loss: 0.8328 train_roc: 0.9002 train_ap: 0.8912 time: 2.2041s
INFO:root:Epoch: 0225 val_loss: 0.7119 val_roc: 0.9262 val_ap: 0.9135
INFO:root:Epoch: 0230 lr: 0.01 train_loss: 0.8164 train_roc: 0.9017 train_ap: 0.8891 time: 2.1967s
INFO:root:Epoch: 0230 val_loss: 0.7083 val_roc: 0.9264 val_ap: 0.9137
INFO:root:Epoch: 0235 lr: 0.01 train_loss: 0.8063 train_roc: 0.9054 train_ap: 0.8938 time: 2.1580s
INFO:root:Epoch: 0235 val_loss: 0.7061 val_roc: 0.9275 val_ap: 0.9150
INFO:root:Epoch: 0240 lr: 0.01 train_loss: 0.8323 train_roc: 0.9001 train_ap: 0.8858 time: 2.2297s
INFO:root:Epoch: 0240 val_loss: 0.7042 val_roc: 0.9279 val_ap: 0.9157
INFO:root:Epoch: 0245 lr: 0.01 train_loss: 0.8212 train_roc: 0.8996 train_ap: 0.8858 time: 2.2385s
INFO:root:Epoch: 0245 val_loss: 0.7192 val_roc: 0.9283 val_ap: 0.9166
INFO:root:Epoch: 0250 lr: 0.01 train_loss: 0.8192 train_roc: 0.8984 train_ap: 0.8861 time: 2.1600s
INFO:root:Epoch: 0250 val_loss: 0.7260 val_roc: 0.9273 val_ap: 0.9156
INFO:root:Epoch: 0255 lr: 0.01 train_loss: 0.8210 train_roc: 0.8997 train_ap: 0.8851 time: 2.2308s
INFO:root:Epoch: 0255 val_loss: 0.7126 val_roc: 0.9249 val_ap: 0.9122
INFO:root:Epoch: 0260 lr: 0.01 train_loss: 0.8295 train_roc: 0.9000 train_ap: 0.8865 time: 0.7090s
INFO:root:Epoch: 0260 val_loss: 0.7096 val_roc: 0.9258 val_ap: 0.9126
INFO:root:Epoch: 0265 lr: 0.01 train_loss: 0.8144 train_roc: 0.9014 train_ap: 0.8892 time: 0.7202s
INFO:root:Epoch: 0265 val_loss: 0.7575 val_roc: 0.9275 val_ap: 0.9145
INFO:root:Epoch: 0270 lr: 0.01 train_loss: 0.8064 train_roc: 0.9074 train_ap: 0.8918 time: 0.7088s
INFO:root:Epoch: 0270 val_loss: 0.7190 val_roc: 0.9261 val_ap: 0.9128
INFO:root:Epoch: 0275 lr: 0.01 train_loss: 0.8659 train_roc: 0.8971 train_ap: 0.8825 time: 0.7162s
INFO:root:Epoch: 0275 val_loss: 0.7128 val_roc: 0.9254 val_ap: 0.9125
INFO:root:Epoch: 0280 lr: 0.01 train_loss: 0.8021 train_roc: 0.9047 train_ap: 0.8886 time: 0.7111s
INFO:root:Epoch: 0280 val_loss: 0.7079 val_roc: 0.9260 val_ap: 0.9134
INFO:root:Epoch: 0285 lr: 0.01 train_loss: 0.8279 train_roc: 0.8967 train_ap: 0.8815 time: 0.7189s
INFO:root:Epoch: 0285 val_loss: 0.7336 val_roc: 0.9248 val_ap: 0.9128
INFO:root:Epoch: 0290 lr: 0.01 train_loss: 0.7959 train_roc: 0.9092 train_ap: 0.8964 time: 0.7078s
INFO:root:Epoch: 0290 val_loss: 0.7393 val_roc: 0.9266 val_ap: 0.9147
INFO:root:Epoch: 0295 lr: 0.01 train_loss: 0.7982 train_roc: 0.9029 train_ap: 0.8889 time: 0.7143s
INFO:root:Epoch: 0295 val_loss: 0.7035 val_roc: 0.9267 val_ap: 0.9132
INFO:root:Epoch: 0300 lr: 0.01 train_loss: 0.8471 train_roc: 0.8941 train_ap: 0.8802 time: 0.7126s
INFO:root:Epoch: 0300 val_loss: 0.7113 val_roc: 0.9248 val_ap: 0.9105
INFO:root:Epoch: 0305 lr: 0.01 train_loss: 0.8144 train_roc: 0.8987 train_ap: 0.8822 time: 0.7215s
INFO:root:Epoch: 0305 val_loss: 0.7070 val_roc: 0.9264 val_ap: 0.9127
INFO:root:Epoch: 0310 lr: 0.01 train_loss: 0.8109 train_roc: 0.9047 train_ap: 0.8896 time: 0.7616s
INFO:root:Epoch: 0310 val_loss: 0.7244 val_roc: 0.9270 val_ap: 0.9146
INFO:root:Epoch: 0315 lr: 0.01 train_loss: 0.8552 train_roc: 0.8967 train_ap: 0.8796 time: 0.7133s
INFO:root:Epoch: 0315 val_loss: 0.7081 val_roc: 0.9276 val_ap: 0.9158
INFO:root:Epoch: 0320 lr: 0.01 train_loss: 0.8255 train_roc: 0.9001 train_ap: 0.8845 time: 0.7244s
INFO:root:Epoch: 0320 val_loss: 0.7025 val_roc: 0.9273 val_ap: 0.9150
INFO:root:Epoch: 0325 lr: 0.01 train_loss: 0.8050 train_roc: 0.9028 train_ap: 0.8884 time: 0.7206s
INFO:root:Epoch: 0325 val_loss: 0.7073 val_roc: 0.9271 val_ap: 0.9152
INFO:root:Epoch: 0330 lr: 0.01 train_loss: 0.8558 train_roc: 0.9060 train_ap: 0.8910 time: 0.7103s
INFO:root:Epoch: 0330 val_loss: 0.7175 val_roc: 0.9272 val_ap: 0.9154
INFO:root:Epoch: 0335 lr: 0.01 train_loss: 0.8085 train_roc: 0.9005 train_ap: 0.8875 time: 0.7064s
INFO:root:Epoch: 0335 val_loss: 0.7097 val_roc: 0.9262 val_ap: 0.9137
INFO:root:Epoch: 0340 lr: 0.01 train_loss: 0.8016 train_roc: 0.9036 train_ap: 0.8894 time: 0.7121s
INFO:root:Epoch: 0340 val_loss: 0.7084 val_roc: 0.9260 val_ap: 0.9137
INFO:root:Epoch: 0345 lr: 0.01 train_loss: 0.8192 train_roc: 0.9027 train_ap: 0.8889 time: 0.7240s
INFO:root:Epoch: 0345 val_loss: 0.7118 val_roc: 0.9268 val_ap: 0.9156
INFO:root:Early stopping
INFO:root:Optimization Finished!
INFO:root:Total time elapsed: 552.8269s
INFO:root:Val set results: val_loss: 0.7258 val_roc: 0.9283 val_ap: 0.9167
INFO:root:Test set results: test_loss: 0.7167 test_roc: 0.9273 test_ap: 0.9142
INFO:root:Saved model in /workspace/xiongbo/hgcn/logs/lp/2021_5_7/4
