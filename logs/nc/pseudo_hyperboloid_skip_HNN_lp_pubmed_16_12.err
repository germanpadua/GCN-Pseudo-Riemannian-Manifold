INFO:root:Using: cuda:0
INFO:root:Using seed 1234.
INFO:root:LPModel(
  (encoder): HNN(
    (layers): Sequential(
      (0): HNNLayer(
        (linear): HypLinear(
          in_features=501, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
      (1): HNNLayer(
        (linear): HypLinear(
          in_features=16, out_features=16, c=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
        (hyp_act): HypAct(
          c_in=Parameter containing:
          tensor([-1.], requires_grad=True), c_out=Parameter containing:
          tensor([-1.], requires_grad=True)
        )
      )
    )
  )
  (dc): FermiDiracDecoder()
)
INFO:root:Total number of parameters: 8305
/workspace/anaconda3/envs/geo/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:370: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  "please use `get_last_lr()`.", UserWarning)
INFO:root:Epoch: 0005 lr: 0.01 train_loss: 1.8874 train_roc: 0.5806 train_ap: 0.5762 time: 2.3589s
INFO:root:Epoch: 0005 val_loss: 1.8788 val_roc: 0.5902 val_ap: 0.5776
INFO:root:Epoch: 0010 lr: 0.01 train_loss: 1.8701 train_roc: 0.5758 train_ap: 0.5707 time: 2.4206s
INFO:root:Epoch: 0010 val_loss: 1.6816 val_roc: 0.5998 val_ap: 0.5943
INFO:root:Epoch: 0015 lr: 0.01 train_loss: 1.7192 train_roc: 0.5910 train_ap: 0.5801 time: 0.7642s
INFO:root:Epoch: 0015 val_loss: 1.5171 val_roc: 0.6177 val_ap: 0.6143
INFO:root:Epoch: 0020 lr: 0.01 train_loss: 1.4568 train_roc: 0.6118 train_ap: 0.6143 time: 0.7771s
INFO:root:Epoch: 0020 val_loss: 1.3904 val_roc: 0.6398 val_ap: 0.6401
INFO:root:Epoch: 0025 lr: 0.01 train_loss: 1.3918 train_roc: 0.6366 train_ap: 0.6350 time: 0.7512s
INFO:root:Epoch: 0025 val_loss: 1.3316 val_roc: 0.6833 val_ap: 0.6729
INFO:root:Epoch: 0030 lr: 0.01 train_loss: 1.3658 train_roc: 0.6734 train_ap: 0.6730 time: 0.7729s
INFO:root:Epoch: 0030 val_loss: 1.1752 val_roc: 0.7638 val_ap: 0.7486
INFO:root:Epoch: 0035 lr: 0.01 train_loss: 1.2810 train_roc: 0.7400 train_ap: 0.7349 time: 0.7689s
INFO:root:Epoch: 0035 val_loss: 1.0411 val_roc: 0.8207 val_ap: 0.8025
INFO:root:Epoch: 0040 lr: 0.01 train_loss: 1.1654 train_roc: 0.7683 train_ap: 0.7558 time: 0.7255s
INFO:root:Epoch: 0040 val_loss: 0.9835 val_roc: 0.8431 val_ap: 0.8244
INFO:root:Epoch: 0045 lr: 0.01 train_loss: 1.1076 train_roc: 0.7951 train_ap: 0.7817 time: 0.7212s
INFO:root:Epoch: 0045 val_loss: 0.9346 val_roc: 0.8615 val_ap: 0.8450
INFO:root:Epoch: 0050 lr: 0.01 train_loss: 1.0526 train_roc: 0.8221 train_ap: 0.8119 time: 0.7352s
INFO:root:Epoch: 0050 val_loss: 0.9000 val_roc: 0.8762 val_ap: 0.8616
INFO:root:Epoch: 0055 lr: 0.01 train_loss: 1.0471 train_roc: 0.8234 train_ap: 0.8210 time: 0.7080s
INFO:root:Epoch: 0055 val_loss: 0.8860 val_roc: 0.8801 val_ap: 0.8651
INFO:root:Epoch: 0060 lr: 0.01 train_loss: 1.0165 train_roc: 0.8320 train_ap: 0.8137 time: 0.7152s
INFO:root:Epoch: 0060 val_loss: 0.8500 val_roc: 0.8899 val_ap: 0.8769
INFO:root:Epoch: 0065 lr: 0.01 train_loss: 1.0238 train_roc: 0.8339 train_ap: 0.8269 time: 0.7331s
INFO:root:Epoch: 0065 val_loss: 0.8168 val_roc: 0.8974 val_ap: 0.8843
INFO:root:Epoch: 0070 lr: 0.01 train_loss: 1.0480 train_roc: 0.8389 train_ap: 0.8210 time: 0.7183s
INFO:root:Epoch: 0070 val_loss: 0.8116 val_roc: 0.8993 val_ap: 0.8857
INFO:root:Epoch: 0075 lr: 0.01 train_loss: 0.9878 train_roc: 0.8423 train_ap: 0.8240 time: 0.7419s
INFO:root:Epoch: 0075 val_loss: 0.8012 val_roc: 0.9022 val_ap: 0.8891
INFO:root:Epoch: 0080 lr: 0.01 train_loss: 0.9414 train_roc: 0.8626 train_ap: 0.8496 time: 0.7039s
INFO:root:Epoch: 0080 val_loss: 0.7952 val_roc: 0.9048 val_ap: 0.8924
INFO:root:Epoch: 0085 lr: 0.01 train_loss: 0.9513 train_roc: 0.8599 train_ap: 0.8448 time: 0.7045s
INFO:root:Epoch: 0085 val_loss: 0.7846 val_roc: 0.9080 val_ap: 0.8955
INFO:root:Epoch: 0090 lr: 0.01 train_loss: 0.9157 train_roc: 0.8674 train_ap: 0.8514 time: 0.7159s
INFO:root:Epoch: 0090 val_loss: 0.7763 val_roc: 0.9090 val_ap: 0.8968
INFO:root:Epoch: 0095 lr: 0.01 train_loss: 0.9460 train_roc: 0.8614 train_ap: 0.8487 time: 0.7183s
INFO:root:Epoch: 0095 val_loss: 0.7734 val_roc: 0.9094 val_ap: 0.8973
INFO:root:Epoch: 0100 lr: 0.01 train_loss: 0.8896 train_roc: 0.8772 train_ap: 0.8626 time: 0.7102s
INFO:root:Epoch: 0100 val_loss: 0.7755 val_roc: 0.9101 val_ap: 0.8985
INFO:root:Epoch: 0105 lr: 0.01 train_loss: 0.9018 train_roc: 0.8727 train_ap: 0.8593 time: 0.7127s
INFO:root:Epoch: 0105 val_loss: 0.7740 val_roc: 0.9120 val_ap: 0.9005
INFO:root:Epoch: 0110 lr: 0.01 train_loss: 0.9100 train_roc: 0.8700 train_ap: 0.8533 time: 0.7168s
INFO:root:Epoch: 0110 val_loss: 0.7556 val_roc: 0.9156 val_ap: 0.9027
INFO:root:Epoch: 0115 lr: 0.01 train_loss: 0.8649 train_roc: 0.8839 train_ap: 0.8688 time: 0.7168s
INFO:root:Epoch: 0115 val_loss: 0.7464 val_roc: 0.9178 val_ap: 0.9042
INFO:root:Epoch: 0120 lr: 0.01 train_loss: 0.8874 train_roc: 0.8784 train_ap: 0.8656 time: 0.7434s
INFO:root:Epoch: 0120 val_loss: 0.7409 val_roc: 0.9176 val_ap: 0.9034
INFO:root:Epoch: 0125 lr: 0.01 train_loss: 0.9366 train_roc: 0.8675 train_ap: 0.8542 time: 0.7321s
INFO:root:Epoch: 0125 val_loss: 0.7400 val_roc: 0.9176 val_ap: 0.9029
INFO:root:Epoch: 0130 lr: 0.01 train_loss: 0.8771 train_roc: 0.8806 train_ap: 0.8658 time: 0.7211s
INFO:root:Epoch: 0130 val_loss: 0.7367 val_roc: 0.9186 val_ap: 0.9043
INFO:root:Epoch: 0135 lr: 0.01 train_loss: 0.8918 train_roc: 0.8828 train_ap: 0.8695 time: 0.7482s
INFO:root:Epoch: 0135 val_loss: 0.7401 val_roc: 0.9200 val_ap: 0.9055
INFO:root:Epoch: 0140 lr: 0.01 train_loss: 0.9220 train_roc: 0.8692 train_ap: 0.8517 time: 0.7034s
INFO:root:Epoch: 0140 val_loss: 0.7402 val_roc: 0.9200 val_ap: 0.9058
INFO:root:Epoch: 0145 lr: 0.01 train_loss: 0.8626 train_roc: 0.8846 train_ap: 0.8689 time: 0.7209s
INFO:root:Epoch: 0145 val_loss: 0.7402 val_roc: 0.9190 val_ap: 0.9048
INFO:root:Epoch: 0150 lr: 0.01 train_loss: 0.8642 train_roc: 0.8910 train_ap: 0.8793 time: 0.7180s
INFO:root:Epoch: 0150 val_loss: 0.7401 val_roc: 0.9176 val_ap: 0.9028
INFO:root:Epoch: 0155 lr: 0.01 train_loss: 0.8659 train_roc: 0.8827 train_ap: 0.8649 time: 0.7156s
INFO:root:Epoch: 0155 val_loss: 0.7401 val_roc: 0.9173 val_ap: 0.9024
INFO:root:Epoch: 0160 lr: 0.01 train_loss: 0.8918 train_roc: 0.8770 train_ap: 0.8661 time: 0.7259s
INFO:root:Epoch: 0160 val_loss: 0.7388 val_roc: 0.9177 val_ap: 0.9027
INFO:root:Epoch: 0165 lr: 0.01 train_loss: 0.8723 train_roc: 0.8812 train_ap: 0.8647 time: 0.7315s
INFO:root:Epoch: 0165 val_loss: 0.7423 val_roc: 0.9176 val_ap: 0.9032
INFO:root:Epoch: 0170 lr: 0.01 train_loss: 0.8564 train_roc: 0.8866 train_ap: 0.8727 time: 0.7596s
INFO:root:Epoch: 0170 val_loss: 0.7482 val_roc: 0.9175 val_ap: 0.9050
INFO:root:Epoch: 0175 lr: 0.01 train_loss: 0.8804 train_roc: 0.8932 train_ap: 0.8791 time: 0.7374s
INFO:root:Epoch: 0175 val_loss: 0.7513 val_roc: 0.9195 val_ap: 0.9074
INFO:root:Epoch: 0180 lr: 0.01 train_loss: 0.8364 train_roc: 0.8930 train_ap: 0.8783 time: 0.7158s
INFO:root:Epoch: 0180 val_loss: 0.7317 val_roc: 0.9202 val_ap: 0.9076
INFO:root:Epoch: 0185 lr: 0.01 train_loss: 0.8206 train_roc: 0.8990 train_ap: 0.8840 time: 0.7214s
INFO:root:Epoch: 0185 val_loss: 0.7303 val_roc: 0.9209 val_ap: 0.9086
INFO:root:Epoch: 0190 lr: 0.01 train_loss: 0.8293 train_roc: 0.8950 train_ap: 0.8805 time: 0.7120s
INFO:root:Epoch: 0190 val_loss: 0.7288 val_roc: 0.9220 val_ap: 0.9102
INFO:root:Epoch: 0195 lr: 0.01 train_loss: 0.8433 train_roc: 0.8909 train_ap: 0.8742 time: 0.7077s
INFO:root:Epoch: 0195 val_loss: 0.7211 val_roc: 0.9227 val_ap: 0.9095
INFO:root:Epoch: 0200 lr: 0.01 train_loss: 0.8649 train_roc: 0.8831 train_ap: 0.8689 time: 0.7236s
INFO:root:Epoch: 0200 val_loss: 0.7233 val_roc: 0.9225 val_ap: 0.9097
INFO:root:Epoch: 0205 lr: 0.01 train_loss: 0.8199 train_roc: 0.8968 train_ap: 0.8805 time: 0.7236s
INFO:root:Epoch: 0205 val_loss: 0.7478 val_roc: 0.9201 val_ap: 0.9080
INFO:root:Epoch: 0210 lr: 0.01 train_loss: 0.8480 train_roc: 0.8893 train_ap: 0.8718 time: 0.7119s
INFO:root:Epoch: 0210 val_loss: 0.7438 val_roc: 0.9198 val_ap: 0.9071
INFO:root:Epoch: 0215 lr: 0.01 train_loss: 0.8641 train_roc: 0.8883 train_ap: 0.8754 time: 0.7211s
INFO:root:Epoch: 0215 val_loss: 0.7396 val_roc: 0.9207 val_ap: 0.9079
INFO:root:Epoch: 0220 lr: 0.01 train_loss: 0.8471 train_roc: 0.8908 train_ap: 0.8764 time: 0.7252s
INFO:root:Epoch: 0220 val_loss: 0.7207 val_roc: 0.9227 val_ap: 0.9095
INFO:root:Epoch: 0225 lr: 0.01 train_loss: 0.8790 train_roc: 0.8818 train_ap: 0.8734 time: 0.7147s
INFO:root:Epoch: 0225 val_loss: 0.7194 val_roc: 0.9241 val_ap: 0.9116
INFO:root:Epoch: 0230 lr: 0.01 train_loss: 0.8460 train_roc: 0.8996 train_ap: 0.8833 time: 0.7167s
INFO:root:Epoch: 0230 val_loss: 0.7249 val_roc: 0.9248 val_ap: 0.9123
INFO:root:Epoch: 0235 lr: 0.01 train_loss: 0.8305 train_roc: 0.8939 train_ap: 0.8794 time: 2.1937s
INFO:root:Epoch: 0235 val_loss: 0.7165 val_roc: 0.9249 val_ap: 0.9116
INFO:root:Epoch: 0240 lr: 0.01 train_loss: 0.8132 train_roc: 0.9008 train_ap: 0.8857 time: 2.1966s
INFO:root:Epoch: 0240 val_loss: 0.7129 val_roc: 0.9247 val_ap: 0.9108
INFO:root:Epoch: 0245 lr: 0.01 train_loss: 0.8732 train_roc: 0.8889 train_ap: 0.8737 time: 2.2652s
INFO:root:Epoch: 0245 val_loss: 0.7151 val_roc: 0.9258 val_ap: 0.9124
INFO:root:Epoch: 0250 lr: 0.01 train_loss: 0.8390 train_roc: 0.8919 train_ap: 0.8791 time: 2.2241s
INFO:root:Epoch: 0250 val_loss: 0.7385 val_roc: 0.9238 val_ap: 0.9130
INFO:root:Epoch: 0255 lr: 0.01 train_loss: 0.8385 train_roc: 0.8941 train_ap: 0.8774 time: 2.2439s
INFO:root:Epoch: 0255 val_loss: 0.7361 val_roc: 0.9204 val_ap: 0.9094
INFO:root:Epoch: 0260 lr: 0.01 train_loss: 0.8538 train_roc: 0.8970 train_ap: 0.8835 time: 2.2662s
INFO:root:Epoch: 0260 val_loss: 0.7288 val_roc: 0.9216 val_ap: 0.9099
INFO:root:Epoch: 0265 lr: 0.01 train_loss: 0.8328 train_roc: 0.8935 train_ap: 0.8805 time: 2.2563s
INFO:root:Epoch: 0265 val_loss: 0.7266 val_roc: 0.9227 val_ap: 0.9098
INFO:root:Epoch: 0270 lr: 0.01 train_loss: 0.8540 train_roc: 0.8888 train_ap: 0.8726 time: 2.2848s
INFO:root:Epoch: 0270 val_loss: 0.7377 val_roc: 0.9215 val_ap: 0.9069
INFO:root:Epoch: 0275 lr: 0.01 train_loss: 0.8453 train_roc: 0.8903 train_ap: 0.8742 time: 2.3116s
INFO:root:Epoch: 0275 val_loss: 0.7245 val_roc: 0.9240 val_ap: 0.9095
INFO:root:Epoch: 0280 lr: 0.01 train_loss: 0.8348 train_roc: 0.8934 train_ap: 0.8806 time: 2.2647s
INFO:root:Epoch: 0280 val_loss: 0.7162 val_roc: 0.9236 val_ap: 0.9095
INFO:root:Epoch: 0285 lr: 0.01 train_loss: 0.8158 train_roc: 0.9007 train_ap: 0.8867 time: 2.2452s
INFO:root:Epoch: 0285 val_loss: 0.7238 val_roc: 0.9224 val_ap: 0.9095
INFO:root:Epoch: 0290 lr: 0.01 train_loss: 0.8319 train_roc: 0.8946 train_ap: 0.8794 time: 2.2944s
INFO:root:Epoch: 0290 val_loss: 0.7369 val_roc: 0.9215 val_ap: 0.9098
INFO:root:Epoch: 0295 lr: 0.01 train_loss: 0.8366 train_roc: 0.8924 train_ap: 0.8790 time: 2.2388s
INFO:root:Epoch: 0295 val_loss: 0.7339 val_roc: 0.9225 val_ap: 0.9108
INFO:root:Epoch: 0300 lr: 0.01 train_loss: 0.8417 train_roc: 0.8910 train_ap: 0.8775 time: 2.2350s
INFO:root:Epoch: 0300 val_loss: 0.7290 val_roc: 0.9226 val_ap: 0.9101
INFO:root:Epoch: 0305 lr: 0.01 train_loss: 0.8597 train_roc: 0.8867 train_ap: 0.8724 time: 2.2705s
INFO:root:Epoch: 0305 val_loss: 0.7220 val_roc: 0.9227 val_ap: 0.9106
INFO:root:Epoch: 0310 lr: 0.01 train_loss: 0.8011 train_roc: 0.9030 train_ap: 0.8886 time: 2.2578s
INFO:root:Epoch: 0310 val_loss: 0.7191 val_roc: 0.9238 val_ap: 0.9127
INFO:root:Epoch: 0315 lr: 0.01 train_loss: 0.8509 train_roc: 0.9018 train_ap: 0.8883 time: 2.2104s
INFO:root:Epoch: 0315 val_loss: 0.7237 val_roc: 0.9250 val_ap: 0.9153
INFO:root:Epoch: 0320 lr: 0.01 train_loss: 0.8318 train_roc: 0.8924 train_ap: 0.8755 time: 2.2179s
INFO:root:Epoch: 0320 val_loss: 0.7143 val_roc: 0.9253 val_ap: 0.9141
INFO:root:Epoch: 0325 lr: 0.01 train_loss: 0.8235 train_roc: 0.8966 train_ap: 0.8805 time: 0.7201s
INFO:root:Epoch: 0325 val_loss: 0.7191 val_roc: 0.9247 val_ap: 0.9122
INFO:root:Epoch: 0330 lr: 0.01 train_loss: 0.7935 train_roc: 0.9048 train_ap: 0.8899 time: 0.7234s
INFO:root:Epoch: 0330 val_loss: 0.7209 val_roc: 0.9249 val_ap: 0.9126
INFO:root:Epoch: 0335 lr: 0.01 train_loss: 0.8221 train_roc: 0.9002 train_ap: 0.8895 time: 0.7434s
INFO:root:Epoch: 0335 val_loss: 0.7205 val_roc: 0.9236 val_ap: 0.9108
INFO:root:Epoch: 0340 lr: 0.01 train_loss: 0.8443 train_roc: 0.8975 train_ap: 0.8822 time: 0.7223s
INFO:root:Epoch: 0340 val_loss: 0.7274 val_roc: 0.9216 val_ap: 0.9078
INFO:root:Epoch: 0345 lr: 0.01 train_loss: 0.8330 train_roc: 0.8985 train_ap: 0.8852 time: 0.7095s
INFO:root:Epoch: 0345 val_loss: 0.7312 val_roc: 0.9219 val_ap: 0.9089
INFO:root:Epoch: 0350 lr: 0.01 train_loss: 0.8381 train_roc: 0.8943 train_ap: 0.8816 time: 0.7130s
INFO:root:Epoch: 0350 val_loss: 0.7228 val_roc: 0.9234 val_ap: 0.9107
INFO:root:Epoch: 0355 lr: 0.01 train_loss: 0.7993 train_roc: 0.9070 train_ap: 0.8917 time: 0.7570s
INFO:root:Epoch: 0355 val_loss: 0.7184 val_roc: 0.9247 val_ap: 0.9121
INFO:root:Epoch: 0360 lr: 0.01 train_loss: 0.8166 train_roc: 0.8999 train_ap: 0.8856 time: 0.7278s
INFO:root:Epoch: 0360 val_loss: 0.7167 val_roc: 0.9244 val_ap: 0.9112
INFO:root:Epoch: 0365 lr: 0.01 train_loss: 0.8401 train_roc: 0.8922 train_ap: 0.8756 time: 0.7324s
INFO:root:Epoch: 0365 val_loss: 0.7133 val_roc: 0.9248 val_ap: 0.9111
INFO:root:Epoch: 0370 lr: 0.01 train_loss: 0.8854 train_roc: 0.8921 train_ap: 0.8768 time: 0.7154s
INFO:root:Epoch: 0370 val_loss: 0.7159 val_roc: 0.9245 val_ap: 0.9116
INFO:root:Epoch: 0375 lr: 0.01 train_loss: 0.8347 train_roc: 0.8949 train_ap: 0.8838 time: 0.7340s
INFO:root:Epoch: 0375 val_loss: 0.7292 val_roc: 0.9219 val_ap: 0.9100
INFO:root:Epoch: 0380 lr: 0.01 train_loss: 0.8325 train_roc: 0.8965 train_ap: 0.8828 time: 0.7324s
INFO:root:Epoch: 0380 val_loss: 0.7289 val_roc: 0.9210 val_ap: 0.9079
INFO:root:Epoch: 0385 lr: 0.01 train_loss: 0.8269 train_roc: 0.9048 train_ap: 0.8904 time: 0.7173s
INFO:root:Epoch: 0385 val_loss: 0.7195 val_roc: 0.9223 val_ap: 0.9078
INFO:root:Epoch: 0390 lr: 0.01 train_loss: 0.8918 train_roc: 0.8952 train_ap: 0.8801 time: 0.7202s
INFO:root:Epoch: 0390 val_loss: 0.7272 val_roc: 0.9258 val_ap: 0.9134
INFO:root:Epoch: 0395 lr: 0.01 train_loss: 0.8371 train_roc: 0.8944 train_ap: 0.8806 time: 0.7168s
INFO:root:Epoch: 0395 val_loss: 0.7169 val_roc: 0.9250 val_ap: 0.9128
INFO:root:Epoch: 0400 lr: 0.01 train_loss: 0.8240 train_roc: 0.8968 train_ap: 0.8797 time: 0.7129s
INFO:root:Epoch: 0400 val_loss: 0.7135 val_roc: 0.9248 val_ap: 0.9112
INFO:root:Epoch: 0405 lr: 0.01 train_loss: 0.8189 train_roc: 0.9005 train_ap: 0.8874 time: 0.7182s
INFO:root:Epoch: 0405 val_loss: 0.7114 val_roc: 0.9255 val_ap: 0.9119
INFO:root:Epoch: 0410 lr: 0.01 train_loss: 0.8100 train_roc: 0.9005 train_ap: 0.8864 time: 0.7425s
INFO:root:Epoch: 0410 val_loss: 0.7194 val_roc: 0.9250 val_ap: 0.9123
INFO:root:Epoch: 0415 lr: 0.01 train_loss: 0.8566 train_roc: 0.8863 train_ap: 0.8694 time: 0.7520s
INFO:root:Epoch: 0415 val_loss: 0.7279 val_roc: 0.9229 val_ap: 0.9104
INFO:root:Early stopping
INFO:root:Optimization Finished!
INFO:root:Total time elapsed: 627.5533s
INFO:root:Val set results: val_loss: 0.7211 val_roc: 0.9255 val_ap: 0.9156
INFO:root:Test set results: test_loss: 0.7182 test_roc: 0.9236 test_ap: 0.9093
INFO:root:Saved model in /workspace/xiongbo/hgcn/logs/lp/2021_5_7/8
